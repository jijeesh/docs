<!DOCTYPE html>
<html class="" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>
      
          
              Hardening Guide v2.2
          
      
  </title>

  <link rel="icon" type="image/png" href="/docs/img/favicon.png">
  <link rel="stylesheet" type="text/css" href="http://jijeesh.github.io/docs/sass/app.min.css?1585318202"/>

  
  
  
  
  
  
  
  

  
  <script charset="utf-8" type="text/javascript" src="http://jijeesh.github.io/docs/js/vendor.min.js?1585318202"></script>

 
  <script defer charset="utf-8" type="text/javascript" src="http://jijeesh.github.io/docs/js/instantsearch.min.js?1585318202"></script>

  
  
    
  <script charset="utf-8" type="text/javascript" src="http://jijeesh.github.io/docs/js/app.min.js?1585318202"></script>

  
  

  <link href="http://jijeesh.github.io/docs/rancher/v2.x/en/security/hardening-2.2/index.xml" rel="alternate" type="application/rss+xml" title="Hardening Guide v2.2" />

  
    <meta name="description" content="This document provides prescriptive guidance for hardening a production installation of Rancher v2.2.x. It outlines the configurations and controls required to address Kubernetes benchmark controls from the Center for Information Security (CIS).
 This hardening guide describes how to secure the nodes in your cluster, and it is recommended to follow this guide before installing Kubernetes.
 This hardening guide is intended to be used with specific versions of the CIS Kubernetes Benchmark, Kubernetes, and Rancher:"/>
  

  
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:title" content="Hardening Guide v2.2" />
  <meta name="twitter:site" content="" />
  <meta name="twitter:creator" content="" />

  
  <meta property="og:locale" content="en_US" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Hardening Guide v2.2">
  <meta property="og:description" content="">
  <meta property="og:url" content="http://jijeesh.github.io/docs/rancher/v2.x/en/security/hardening-2.2/" />
  <meta property="og:site_name" content="Rancher Labs" />
  <meta property="og:image" content="http://jijeesh.github.io/docs/img/logo-square.png" />
  
  



  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-57KS2MW');</script>
  

  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56382716-3', 'auto');
  ga('set', 'anonymizeIp', true);
  ga('send', 'pageview');

  </script>
  
</head>
<body lang="en" class="rancher">
    
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-57KS2MW"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    
  <a name="top"></a>


<div class="main"> 
    <header>
        <nav>
            <div class="mobile-header-container">
                <div class="mobile-nav-header">
                    <div class="logo">
                        <a href="/"><img class="logo-image" src="/imgs/rancher-logo-horiz-color.png" alt="The Logo of Rancher: an Open Source Kubernetes Multi Cluster Management Platform"></a>
                    </div>

                    <div class="mobile-search"><a href="#" class="search-open" data-launch-id="open-search"><img class="icon" src="/imgs/icon-search-mobile.svg" alt="Gray Search Icon"></a></div>

                    <div class="mobile-menu-opener">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>

                <div class="nav-mobile-menus jquery-accordion-menu">
                    <ul class="mobile-menus-wrap">
                        <li class="mobile-menu-item">
                            <a class="mobile-menu" href="#">Why Rancher?</a>

                            <ul class="submenu submenus-wrap">
                                <li class=""><a href="/what-is-rancher/overview/">Why Rancher?</a></li>
                                <li class=""><a href="/kubernetes/">Why Kubernetes?</a></li>
                                <li class=""><a href="/what-is-rancher/what-rancher-adds-to-kubernetes/">What Rancher Adds to Kubernetes</a></li>
                                <li class=""><a href="/what-is-rancher/how-is-rancher-different/">The Rancher Difference</a></li>
                            </ul>
                        </li>
                        <li class="mobile-menu-item">
                            <a class="mobile-menu" href="#">Products</a>

                            <ul class="submenu submenus-wrap">
                                <li><a href="/products/">Overview</a></li>
                                <li><a href="/products/rancher/">Rancher</a></li>
                                <li><a href="https://k3s.io" target="_blank">k3s</a></li>
                                <li><a href="https://rio.io" target="_blank">Rio</a></li>
                                <li><a href="/request-a-demo/">Request a demo</a></li>
                            </ul>
                        </li>
                        <li class="mobile-menu-item">
                            <a class="mobile-menu" href="#">Customers</a>

                            <ul class="submenu submenus-wrap">
                                <li><a href="/customers/illumina/">Illumina</a></li>
                                <li><a href="/customers/sling/">Sling TV</a></li>
                                <li><a href="/customers/eoc/">EOC</a></li>
                                <li><a href="/customers/deutsche-bahn/">Deutsche Bahn</a></li>
                                <li><a href="/customers/">See All Customer Stories</a></li>
                            </ul>
                        </li>
                        <li class="mobile-menu-item">
                            <a class="mobile-menu" href="#">Community</a>

                            <ul class="submenu submenus-wrap">
                                <li><a href="/community">Overview</a></li>
                                <li><a href="/learning-paths">Learning Paths</a></li>
                                <li><a href="/training/">Training</a></li>
                                <li><a href="/tutorials/">Tutorials</a></li>
                                <li><a href="/events/">Events</a></li>
                                <li><a href="/online-meetups/">Online Meetups</a></li>
                                <li><a href="/rodeos/">Rancher Rodeos</a></li>
                                <li><a href="/kubernetes-master-class/">Kubernetes Master Classes</a></li>
                                
                                <li><a href="/quick-start/">Getting Started Guide</a></li>
                                <li><a href="https://forums.rancher.com/">Forums</a></li>
                                <li><a href="http://slack.rancher.io/">Slack</a></li>
                                <li><a href="https://github.com/rancher">Github</a></li>
                            </ul>
                        </li>
                        <li class="mobile-menu-item">
                        <a class="mobile-menu" href="#">Resources</a>

                            <ul class="submenu submenus-wrap">
                                <li><a href="/docs">Docs</a></li>
                                <li><a href="/resources/#analyst-reports">Analyst Reports</a></li>
                                <li><a href="/resources/#whitepapers">White Papers</a></li>
                                <li><a href="/resources/#ebooks">Ebooks</a></li>
                                <li><a href="/resources/#videos">Videos</a></li>
                                <li><a href="/resources/#podcasts">Podcasts</a></li>
                                <li><a href="/blog/">Blog</a></li>
                            </ul>
                        </li>
                        <li class="mobile-menu-item">
                        <a class="mobile-menu" href="#">Projects</a>

                            <ul class="submenu submenus-wrap">
                                <li><a href="/rancher-os/">RancherOS</a></li>
                                <li><a href="http://k3os.io/" target="_blank">k3OS</a></li>
                                <li><a href="http://submariner.io/" target="_blank">Submariner</a></li>
                                <li><a href="https://longhorn.io/" target="_blank">Longhorn</a></li>
                            </ul>
                        </li>
                        <li class="mobile-menu-item">
                            <a class="mobile-menu" href="#">Company</a>

                            <ul class="submenu submenus-wrap">
                                <li><a href="/about/">About us</a></li>
                                <li><a href="/partners/">Partners</a></li>
                                <li><a href="/press/">Press</a></li>
                                <li><a href="/events/">Events</a></li>
                                <li><a href="/careers/">Careers</a></li>
                                <li><a href="/blog/">Blog</a></li>
                            </ul>
                        </li>

                        <li class="mobile-menu-item option-menu"><a href="/docs/">Docs</a></li>
                        <li class="mobile-menu-item option-menu"><a href="/support">Support</a></li>
                        <li class="mobile-menu-item option-menu"><a href="/request-a-demo/">Request a demo</a></li>
                        <li class="mobile-menu-item option-menu"><a href="/contact/">Contact</a></li>
                        <li class="mobile-menu-item option-menu"><a href="/pricing/">Pricing</a></li>
                        <li class="mobile-menu-item option-menu get-started"><a href="/quick-start/">Get started</a></li>
                    </ul>
                </div>
            </div>

            <div class="header-container">
                <div class="header-wrap">
                    <div class="header-option-menus">
                        <ul>
                            <li><a href="/docs/">Docs</a></li>
                            <li><a href="/request-a-demo/">Request a demo</a></li>
                            <li><a href="/pricing/">Pricing</a></li>
                            <li><a href="/support">Support</a></li>
                            <li><a href="/contact/">Contact</a></li>
                            <li class="search"><a href="#" class="search-open" data-launch-id="open-search"><img class="icon" src="/imgs/icon-search.svg"></a></li>
                        </ul>
                    </div>

                    <div class="header-primary-menus">
                        <div class="logo">
                            <a href="/"><img class="logo-image" src="/imgs/rancher-logo-horiz-color.png" alt="Rancher Logo"></a>
                        </div>

                        <div class="primary-menus">
                            <ul class="primary-menus-wrap">
                                <li class='primary-menu-item menu-why_rancher '>
                                    <a class="primary-menu" href="/what-is-rancher/overview">Why RANCHER?</a>

                                    <ul class="primary-menus-sub">
                                        <div class="grid-container">
                                            <div class="row">
                                                <div class="col">
                                                    <li class="menus-container">
                                                        <a href="/what-is-rancher/overview/">
                                                            <span>Why Rancher?</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"></path>
                                                                    <path d="m24.5 17h-15"></path>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                        <a href="/kubernetes/">
                                                            <span>Why Kubernetes?</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"></path>
                                                                    <path d="m24.5 17h-15"></path>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                        <a href="/what-is-rancher/what-rancher-adds-to-kubernetes/">
                                                            <span>What Rancher Adds to Kubernetes </span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"></path>
                                                                    <path d="m24.5 17h-15"></path>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                        <a href="/what-is-rancher/how-is-rancher-different/">
                                                            <span>The Rancher Difference </span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"></path>
                                                                    <path d="m24.5 17h-15"></path>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                    </li>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                </li>
                                <li class='primary-menu-item menu-products '>
                                    <a class="primary-menu" href="/products">Products</a>
                                    <ul class="primary-menus-sub">
                                        <div class="grid-container">
                                            <div class="row">
                                                <div class="col-12 right">

                                                    <ul>
                                                        <li class="menus-container">
                                                            <a href="/products">
                                                                <span>Overview</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"></path>
                                                                    <path d="m24.5 17h-15"></path>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                            <a href="/products/rancher/" class="menu-sub-block-item">
                                                                <span>Rancher</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"></path>
                                                                    <path d="m24.5 17h-15"></path>
                                                                </g>
                                                            </svg>
                                                            </a>
                                                            <a href="/products/rke/" class="menu-sub-block-item">
                                                                <span>RKE</span>

                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"></path>
                                                                    <path d="m24.5 17h-15"></path>
                                                                </g>
                                                            </svg>
                                                            </a>

                                                            <a href="https://k3s.io" class="menu-sub-block-item" target="_blank">
                                                                <span>K3s <svg class='icon-horizontal-center' style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="currentColor" d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z" />
                                                            </svg>
                                                            </span>

                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"></path>
                                                                    <path d="m24.5 17h-15"></path>
                                                                </g>
                                                            </svg>
                                                            </a>
                                                            <a href="https://rio.io" class="menu-sub-block-item" target="_blank">
                                                                <span>Rio <svg class='icon-horizontal-center' style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="currentColor" d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z" /></span>


                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"></path>
                                                                    <path d="m24.5 17h-15"></path>
                                                                </g>
                                                            </svg>
                                                            </a>

                                                        </li>

                                                    </ul>

                                            <div class="primary-menu-blocks primary-menu-blocks-join">
                                                <div class="menus-container menu-container-button">
                                                    <a class="box" href="/request-a-demo/">
                                                        <span>Request a demo</span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                </li>
                                <li class='primary-menu-item menu-customers '>
                                    <a class="primary-menu" href="/customers">Customers</a>

                                    <ul class="primary-menus-sub">
                                        <div class="grid-container">
                                            <div class="row">
                                                <div class="col left">
                                                    <li class="feature-container single split-half">
                                                        <div class="label">Featured</div>

                                                        <div class="article-item">
                                                            <div class="article-thumbmail">
                                                                <img class="image" src="/img/header-customers-featured-thumbnail.png" alt="A Male Scientist in a White Lab Coat Looking Into a Microscope">
                                                            </div>

                                                            <div class="article-texts">
                                                                <a href="/customers/illumina/">
                                                                    <h2 class="title-label">Illumina</h2>
                                                                    <p class="description-label">
                                                                        Illumina Innovates with Rancher and Kubernetes

                                                                        <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                            <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                                <path d="m19.5 12 5 5-5 5"/>
                                                                                <path d="m24.5 17h-15"/>
                                                                            </g>
                                                                        </svg>
                                                                    </p>
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </li>
                                                </div>
                                                <div class="col right">
                                                    <li class="menus-container">
                                                        <div class="label">More Customers</div>

                                                        <a href="/customers/sling/">
                                                            <span>Sling TV</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"/>
                                                                    <path d="m24.5 17h-15"/>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                        <a href="/customers/eoc/">
                                                            <span>EOC</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"/>
                                                                    <path d="m24.5 17h-15"/>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                        <a href="/customers/deutsche-bahn/">
                                                            <span>Deutsche Bahn</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"/>
                                                                    <path d="m24.5 17h-15"/>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                        <a class="box" href="/customers/">
                                                            <span>See All Customer Stories</span>
                                                        </a>
                                                    </li>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                </li>
                                <li class='primary-menu-item menu-community '>
                                    <a class="primary-menu" href="/resources/">RESOURCES</a>

                                    <ul class="primary-menus-sub">
                                        <div class="grid-container">
                                            <div class="primary-menu-blocks">
                                                <div class="menu-sub-block">
                                                    <ul>
                                                        <li class="articles-container">
                                                            <div class="label">Community</div>
                                                            <a href="/community/" class="menu-sub-block-item">Community Overview</a>
                                                            <a href="/quick-start/" class="menu-sub-block-item">Getting Started Guide</a>
                                                            <a href="/learning-paths/" class="menu-sub-block-item">Learning Paths</a>
                                                            <a href="/training/" class="menu-sub-block-item">Introductory Training</a>
                                                            <a href="/tutorials/" class="menu-sub-block-item">Tutorials</a>
                                                            <a href="/online-meetups/" class="menu-sub-block-item">Online Meetups</a>
                                                            <a href="/rodeos/" class="menu-sub-block-item">Hands-on Workshops</a>
                                                            <a href="/kubernetes-master-class/" class="menu-sub-block-item">Kubernetes Master Classes</a>
                                                            
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class="menu-sub-block">
                                                    <ul>
                                                        <li class="articles-container">
                                                            <div class="label">Content Library</div>
                                                            <a href="/docs" class="menu-sub-block-item">Docs</a>
                                                            <a href="/resources/#analyst-reports" class="menu-sub-block-item">Analyst Reports</a>
                                                            <a href="/resources/#whitepapers" class="menu-sub-block-item">
                                                            White Papers</a>
                                                            <a href="/resources/#ebooks" class="menu-sub-block-item">Ebooks</a>
                                                            <a href="/resources/#videos" class="menu-sub-block-item">Videos</a>
                                                            <a href="/resources/#podcasts" class="menu-sub-block-item">Podcasts</a>
                                                            <a href="/blog/" class="menu-sub-block-item">Blog</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class="menu-sub-block">
                                                    <ul>
                                                        <li class="articles-container">
                                                            <div class="label">Projects</div>
                                                            <a href="/rancher-os" class="menu-sub-block-item">RancherOS</a>
                                                            <a href="http://k3os.io" target="_blank" class="menu-sub-block-item">k3OS <svg class='icon-horizontal-center' style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="currentColor" d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z" /></a>
                                                            <a href="http://submariner.io" target="_blank" class="menu-sub-block-item">Submariner <svg class='icon-horizontal-center' style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="currentColor" d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z" /></a>
                                                            <a href="https://longhorn.io" target="_blank" class="menu-sub-block-item">Longhorn <svg class='icon-horizontal-center' style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="currentColor" d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z" /></a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="primary-menu-blocks primary-menu-blocks-join">
                                                <div class="menu-sub-block">
                                                    <ul>
                                                        <li class="articles-container">
                                                            <div class="label">Join the Community</div>
                                                            <div class="menu-sub-items">
                                                                <a href="https://forums.rancher.com/" class="menu-sub-block-item">Forums</a>
                                                                <span class="menu-sub-block-item">|</span>
                                                                <a href="http://slack.rancher.io/" class="menu-sub-block-item">Slack</a>
                                                                <span class="menu-sub-block-item">|</span>
                                                                <a href="https://github.com/rancher" class="menu-sub-block-item">Github</a>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                </li>
                                <li class='primary-menu-item menu-company '>
                                    <a class="primary-menu" href="/about/">Company</a>

                                    <ul class="primary-menus-sub">
                                        <div class="grid-container">
                                            <div class="row">
                                                <div class="col">
                                                    <li class="menus-container">
                                                        <a href="/about/">
                                                            <span>About us</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"/>
                                                                    <path d="m24.5 17h-15"/>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                        <a href="/partners/">
                                                            <span>Partners</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"/>
                                                                    <path d="m24.5 17h-15"/>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                        <a href="/press/">
                                                            <span>Press</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"/>
                                                                    <path d="m24.5 17h-15"/>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                        <a href="/events/">
                                                            <span>Events</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"/>
                                                                    <path d="m24.5 17h-15"/>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                        <a href="/careers/">
                                                            <span>Careers</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"/>
                                                                    <path d="m24.5 17h-15"/>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                        <a href="/blog/">
                                                            <span>Blog</span>
                                                            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                                                                <g class="svg-linear" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10">
                                                                    <path d="m19.5 12 5 5-5 5"/>
                                                                    <path d="m24.5 17h-15"/>
                                                                </g>
                                                            </svg>
                                                        </a>
                                                    </li>
                                                </div>
                                            </div>
                                        </div>
                                    </ul>
                                </li>
                                <li class="primary-menu-item menu-get_started get-started">
                                    <a href="/quick-start/">Get started</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </header>



<div class="modal-content" id="open-search">
  <div class="content search-modal">
    
    <div class="container-search">
      <form id="searchForm"><input type="search" id="search-box" autocomplete="off"></input></form>
    </div>

    
    <div class="overlay-search">
      <div class="search-results" id="hits"></div>
    </div>
  </div>
</div>






  <section class="docs-container">
    <div class="grid-container">
      <div class="row max-sized set-lines set-ground">
        <div class="col-4"></div>
        <div class="col-4"></div>
        <div class="col-4"></div>
      </div>

      <div class="head-blank"></div>

      <div class="row max-sized contents-container background-base-gray-side">
        <div class="
        col-xl-3
        col-lg-4
        col-md-4
        col-sm-12
        col-xs-12
        col-12
        side-menus">
        <div class="search-container">
          <input class="search input" placeholder="SEARCH" />
        </div>

        
        

  
    
      
        
      
    
  

  
    
      
        
      
    
  

  
    
      
        
          
        
      
    
  

  
    
      
        
      
    
  



<div class="side-menus-container product-select tree-nav jquery-accordion-menu">
  <ul class="side-menus-wrap">
    <li class="tree-nav-item">
      <a>
        
          
            
              
                
              
            
          
        
          
            
              
                
              
            
          
        
          
            
              
                
                  Rancher 2.x
                
              
            
          
        
          
            
              
                
              
            
          
        
        <span class="submenu-indicator">
          <span class="object1"></span>
          <span class="object2"></span>
          <span class="object3"></span>
        </span>
      </a>

      <ul class="tree-nav-sublist submenu submenus-wrap hide">
        
          
            
              <li><a href="http://jijeesh.github.io/docs/k3s/latest/en/">K3s</a></li>
              
            
          
        
          
            
              <li><a href="http://jijeesh.github.io/docs/rke/latest/en/">RKE</a></li>
              
            
          
        
          
            
              <li><a href="http://jijeesh.github.io/docs/rancher/v2.x/en/">Rancher 2.x</a></li>
              
                <li><a href="https://rancher.com/docs/rancher/v1.6/en/" target="blank">Rancher 1.6</a></li>
              
            
          
        
          
            
              <li><a href="http://jijeesh.github.io/docs/os/v1.x/en/">RancherOS</a></li>
              
            
          
        
      </ul>
    </li>
  </ul>
</div>

<div class="guide-menus-activator">
  
    Hardening Guide v2.2
  

  <span class="indicator">
    <span class="object1"></span>
    <span class="object2"></span>
    <span class="object3"></span>
  </span>
</div>
<div class="side-menus-container guide-menus tree-nav jquery-accordion-menu">
  <ul class="side-menus-wrap second">
    
    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/overview/" class="">Overview<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/overview/architecture/" class="">Architecture</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/overview/architecture-recommendations/" class="">Architecture Recommendations</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/overview/concepts/" class="">Kubernetes Concepts</a>
        </li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/quick-start-guide/" class="">Rancher Deployment Quick Start Guides<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/quick-start-guide/cli/" class="">CLI with Rancher</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/quick-start-guide/deployment/" class="">Deploying Rancher Server<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/quick-start-guide/deployment/amazon-aws-qs/" class="">Rancher AWS Quick Start Guide</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/quick-start-guide/deployment/microsoft-azure-qs/" class="">Rancher Azure Quick Start Guide</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/quick-start-guide/deployment/digital-ocean-qs/" class="">Rancher DigitalOcean Quick Start Guide</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/quick-start-guide/deployment/google-gcp-qs/" class="">Rancher GCP Quick Start Guide</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/quick-start-guide/deployment/quickstart-vagrant/" class="">Vagrant Quick Start</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/quick-start-guide/deployment/quickstart-manual-setup/" class="">Manual Quick Start</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/quick-start-guide/workload/" class="">Deploying Workloads<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/quick-start-guide/workload/quickstart-deploy-workload-ingress/" class="">Workload with Ingress Quick Start</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/quick-start-guide/workload/quickstart-deploy-workload-nodeport/" class="">Workload with NodePort Quick Start</a>
        </li>
</ul></li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/" class="">Installing Rancher<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/requirements/" class="">Installation Requirements<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/requirements/installing-docker/" class="">Installing Docker</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/requirements/ports/" class="">Port Requirements</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/how-ha-works/" class="">About High-availability Installations</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/k8s-install/" class="">Installing Rancher on a Kubernetes Cluster<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/k8s-install/create-nodes-lb/" class="">1. Create Nodes and Load Balancer<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/k8s-install/create-nodes-lb/nginx/" class="">Setting up an NGINX Load Balancer</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/k8s-install/create-nodes-lb/nlb/" class="">Setting up an Amazon NLB Load Balancer</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/k8s-install/kubernetes-rke/" class="">2. Set up a Kubernetes Cluster</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/k8s-install/helm-rancher/" class="">3. Install Rancher on the Kubernetes Cluster</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/other-installation-methods/" class="">Other Installation Methods<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/other-installation-methods/single-node-docker/" class="">Installing Rancher on a Single Node Using Docker<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/other-installation-methods/single-node-docker/troubleshooting/" class="">FAQ and Troubleshooting</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/other-installation-methods/single-node-docker/advanced/" class="">Advanced Options for Docker Installs</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/other-installation-methods/single-node-docker/proxy/" class="">HTTP Proxy Configuration</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/other-installation-methods/single-node-docker/single-node-install-external-lb/" class="">Docker Install with External Load Balancer</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/other-installation-methods/air-gap/" class="">Installing Rancher in an Air Gapped Environment<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/other-installation-methods/air-gap/prepare-nodes/" class="">1. Prepare your Node(s)</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/other-installation-methods/air-gap/populate-private-registry/" class="">2. Collect and Publish Images to your Private Registry</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/other-installation-methods/air-gap/launch-kubernetes/" class="">3. Install Kubernetes with RKE (Kubernetes Installs Only)</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/other-installation-methods/air-gap/install-rancher/" class="">4. Install Rancher</a>
        </li>
</ul></li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/" class="">Resources, References, and Advanced Options<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/" class="">Kubernetes Installation Using Helm 2<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/create-nodes-lb/" class="">1. Create Nodes and Load Balancer<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/create-nodes-lb/nginx/" class="">NGINX</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/create-nodes-lb/nlb/" class="">Amazon NLB</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/kubernetes-rke/" class="">2. Install Kubernetes with RKE<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/kubernetes-rke/troubleshooting/" class="">Troubleshooting</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/helm-init/" class="">Initialize Helm: Install the Tiller Service<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/helm-init/troubleshooting/" class="">Troubleshooting</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/helm-rancher/" class="">4.  Install Rancher<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/helm-rancher/tls-secrets/" class="">Adding Kubernetes TLS Secrets</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/helm-rancher/chart-options/" class="">Chart Options</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/helm-rancher/troubleshooting/" class="">Troubleshooting</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/rke-add-on/" class="">RKE Add-On Install<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/rke-add-on/layer-4-lb/" class="">Kubernetes Install with External Load Balancer (TCP/Layer 4)<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/rke-add-on/layer-4-lb/nlb/" class="">Amazon NLB Configuration</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/rke-add-on/layer-7-lb/" class="">Kubernetes Install with External Load Balancer (HTTPS/Layer 7)<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/rke-add-on/layer-7-lb/alb/" class="">Amazon ALB Configuration</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/rke-add-on/layer-7-lb/nginx/" class="">NGINX Configuration</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/rke-add-on/proxy/" class="">HTTP Proxy Configuration</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/rke-add-on/api-auditing/" class="">Enable API Auditing</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/rke-add-on/troubleshooting/" class="">Troubleshooting HA RKE Add-On Install<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/rke-add-on/troubleshooting/generic-troubleshooting/" class="">Generic troubleshooting</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/rke-add-on/troubleshooting/job-complete-status/" class="">Failed to get job complete status</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm2/rke-add-on/troubleshooting/404-default-backend/" class="">404 - default backend</a>
        </li>
</ul></li>
</ul></li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/air-gap-helm2/" class="">Installing Rancher in an Air Gapped Environment with Helm 2<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/air-gap-helm2/prepare-nodes/" class="">1. Prepare your Node(s)</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/air-gap-helm2/populate-private-registry/" class="">2. Collect and Publish Images to your Private Registry</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/air-gap-helm2/launch-kubernetes/" class="">3. Install Kubernetes with RKE (Kubernetes Installs Only)</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/air-gap-helm2/install-rancher/" class="">4. Install Rancher</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/etcd/" class="">Tuning etcd for Large Installations</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/server-tags/" class="">Choosing a Rancher Version</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/tls-secrets/" class="">Adding TLS Secrets</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/chart-options/" class="">Helm Chart Options for Kubernetes Installations</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/rke-add-on/" class="">RKE Add-On Install<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/rke-add-on/layer-4-lb/" class="">Kubernetes Install with External Load Balancer (TCP/Layer 4)<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/rke-add-on/layer-4-lb/nlb/" class="">Amazon NLB Configuration</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/rke-add-on/layer-7-lb/" class="">Kubernetes Install with External Load Balancer (HTTPS/Layer 7)<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/rke-add-on/layer-7-lb/alb/" class="">Amazon ALB Configuration</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/rke-add-on/layer-7-lb/nginx/" class="">NGINX Configuration</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/rke-add-on/proxy/" class="">HTTP Proxy Configuration</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/rke-add-on/api-auditing/" class="">Enable API Auditing</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/rke-add-on/troubleshooting/" class="">Troubleshooting HA RKE Add-On Install<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/rke-add-on/troubleshooting/generic-troubleshooting/" class="">Generic troubleshooting</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/rke-add-on/troubleshooting/job-complete-status/" class="">Failed to get job complete status</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/rke-add-on/troubleshooting/404-default-backend/" class="">404 - default backend</a>
        </li>
</ul></li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/troubleshooting/" class="">Troubleshooting the Rancher Server Kubernetes Cluster</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/helm-version/" class="">Helm Version Requirements</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/custom-ca-root-certificate/" class="">About Custom CA Root Certificates</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/local-system-charts/" class="">Setting up Local System Charts for Air Gapped Installations</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/upgrading-cert-manager/" class="">Upgrading Cert-Manager<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/upgrading-cert-manager/helm-2-instructions/" class="">Upgrading Cert-Manager with Helm 2</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/arm64-platform/" class="">Running on ARM64 (Experimental)</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/feature-flags/" class="">Enabling Experimental Features<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/feature-flags/enable-not-default-storage-drivers/" class="">Allow Unsupported Storage Drivers</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/feature-flags/istio-virtual-service-ui/" class="">UI for Istio Virtual Services and Destination Rules</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/api-audit-log/" class="">Enabling the API Audit Log to Record System Events</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/tls-settings/" class="">TLS settings</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/installation/options/firewall/" class="">Opening Ports with firewalld</a>
        </li>
</ul></li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/upgrades/" class="">Upgrades and Rollbacks<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/upgrades/upgrades/" class="">Upgrades<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/upgrades/upgrades/single-node/" class="">Upgrading Rancher Installed with Docker</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/upgrades/upgrades/ha/" class="">Upgrading Rancher Installed on Kubernetes<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/upgrades/upgrades/ha/helm2/" class="">Upgrading Rancher Installed on Kubernetes with Helm 2</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/upgrades/upgrades/migrating-from-rke-add-on/" class="">Migrating from a Kubernetes Install with an RKE Add-on</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/upgrades/upgrades/namespace-migration/" class="">Upgrading to v2.0.7&#43; — Namespace Migration</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/upgrades/rollbacks/" class="">Rollbacks<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/upgrades/rollbacks/single-node-rollbacks/" class="">Docker Rollback</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/upgrades/rollbacks/ha-server-rollbacks/" class="">Kubernetes Rollback</a>
        </li>
</ul></li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/backups/" class="">Backups and Disaster Recovery<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/backups/backups/" class="">Backups<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/backups/backups/single-node-backups/" class="">Creating Backups for Rancher Installed with Docker</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/backups/backups/ha-backups/" class="">Creating Backups for Rancher Installed on Kubernetes</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/backups/restorations/" class="">Restorations<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/backups/restorations/single-node-restoration/" class="">Docker Installs</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/backups/restorations/ha-restoration/" class="">Kubernetes Installs</a>
        </li>
</ul></li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/best-practices/" class="">Best Practices Guide<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/best-practices/deployment-strategies/" class="">Rancher Deployment Strategies</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/best-practices/deployment-types/" class="">Tips for Running Rancher</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/best-practices/containers/" class="">Tips for Setting Up Containers</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/best-practices/management/" class="">Tips for Scaling, Security and Reliability</a>
        </li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/" class="">Authentication, Permissions and Global Configuration<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/config-private-registry/" class="">Configuring a Global Default Private Registry</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/" class="">Authentication<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/user-groups/" class="">Users and Groups</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/local/" class="">Local Authentication</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/ad/" class="">Configuring Active Directory (AD)</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/openldap/" class="">Configuring OpenLDAP</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/freeipa/" class="">Configuring FreeIPA</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/azure-ad/" class="">Configuring Azure AD</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/github/" class="">Configuring GitHub</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/keycloak/" class="">Configuring Keycloak (SAML)</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/ping-federate/" class="">Configuring PingIdentity (SAML)</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/microsoft-adfs/" class="">Configuring Microsoft Active Directory Federation Service (SAML)<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/microsoft-adfs/microsoft-adfs-setup/" class="">1 — Configuring Microsoft AD FS for Rancher</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/microsoft-adfs/rancher-adfs-setup/" class="">2 — Configuring Rancher for Microsoft AD FS</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/okta/" class="">Configuring Okta (SAML)</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/authentication/google/" class="">Configuring Google OAuth</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rbac/" class="">Role-Based Access Control (RBAC)<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rbac/global-permissions/" class="">Global Permissions</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rbac/cluster-project-roles/" class="">Cluster and Project Roles</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rbac/default-custom-roles/" class="">Custom Roles</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rbac/locked-roles/" class="">Locked Roles</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/k8s-metadata/" class="">Upgrading Kubernetes without Upgrading Rancher</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/pod-security-policies/" class="">Pod Security Policies</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/drivers/" class="">Provisioning Drivers<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/drivers/cluster-drivers/" class="">Cluster Drivers</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/drivers/node-drivers/" class="">Node Drivers</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rke-templates/" class="">RKE Templates<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rke-templates/example-scenarios/" class="">Example Scenarios</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rke-templates/creator-permissions/" class="">Template Creator Permissions</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rke-templates/template-access-and-sharing/" class="">Access and Sharing</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rke-templates/creating-and-revising/" class="">Creating and Revising Templates</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rke-templates/enforcement/" class="">Template Enforcement</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rke-templates/overrides/" class="">Overriding Template Settings</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rke-templates/applying-templates/" class="">Applying Templates</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rke-templates/example-yaml/" class="">Example YAML</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/admin-settings/rke-templates/rke-templates-and-hardware/" class="">RKE Templates and Infrastructure</a>
        </li>
</ul></li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/" class="">Setting up Kubernetes Clusters in Rancher<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/node-requirements/" class="">Node Requirements for User Clusters</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/production/" class="">Checklist for Production-Ready Clusters<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/production/recommended-architecture/" class="">Recommended Cluster Architecture</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/production/nodes-and-roles/" class="">Roles for Nodes in Kubernetes</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/hosted-kubernetes-clusters/" class="">Setting up Clusters from Hosted Kubernetes Providers<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/hosted-kubernetes-clusters/gke/" class="">Google Kubernetes Engine</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/hosted-kubernetes-clusters/eks/" class="">Amazon EKS</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/hosted-kubernetes-clusters/aks/" class="">Azure Kubernetes Service</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/hosted-kubernetes-clusters/ack/" class="">Alibaba Cloud Container Service for Kubernetes</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/hosted-kubernetes-clusters/tke/" class="">Tencent Kubernetes Engine</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/hosted-kubernetes-clusters/cce/" class="">Huawei Cloud Kubernetes Service</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/" class="">Launching Kubernetes with Rancher<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/node-pools/" class="">Launching Kubernetes on New Nodes in an Infrastructure Provider<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/node-pools/ec2/" class="">Amazon EC2</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/node-pools/digital-ocean/" class="">DigitalOcean</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/node-pools/azure/" class="">Azure</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/node-pools/vsphere/" class="">vSphere<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/node-pools/vsphere/provisioning-vsphere-clusters/" class="">Provisioning Kubernetes Clusters in vSphere<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/node-pools/vsphere/provisioning-vsphere-clusters/creating-credentials/" class="">Creating Credentials in the vSphere Console</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/node-pools/vsphere/provisioning-vsphere-clusters/enabling-uuids/" class="">Enabling Disk UUIDs in Node Templates</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/node-pools/vsphere/provisioning-vsphere-clusters/node-template-reference/" class="">vSphere Node Template Configuration Reference</a>
        </li>
</ul></li>
</ul></li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/custom-nodes/" class="">Launching Kubernetes on Existing Custom Nodes<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/custom-nodes/agent-options/" class="">Rancher Agent Options</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/windows-clusters/" class="">Launching Kubernetes on Windows Clusters<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/windows-clusters/host-gateway-requirements/" class="">Networking Requirements for Host Gateway (L2bridge)</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/windows-clusters/docs-for-2.1-and-2.2/" class="">v2.1.x and v2.2.x Windows Documentation (Experimental)</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/options/" class="">Cluster Configuration Reference<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/options/cloud-providers/" class="">Setting up Cloud Providers</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/options/pod-security-policies/" class="">Assigning Pod Security Policies</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/rke-clusters/rancher-agents/" class="">Rancher Agents</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-provisioning/imported-clusters/" class="">Importing Existing Clusters into Rancher</a>
        </li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/" class="">Cluster Administration<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/cluster-access/" class="">Cluster Access<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/cluster-access/kubectl/" class="">Access a Cluster with Kubectl and kubeconfig</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/cluster-access/ace/" class="">How the Authorized Cluster Endpoint Works</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/cluster-access/cluster-members/" class="">Adding Users to Clusters</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/upgrading-kubernetes/" class="">Upgrading Kubernetes</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/pod-security-policy/" class="">Adding a Pod Security Policy</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/editing-clusters/" class="">Cluster Configuration</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/nodes/" class="">Nodes and Node Pools</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/volumes-and-storage/" class="">Kubernetes Persistent Storage: Volumes and Storage Classes<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/volumes-and-storage/how-storage-works/" class="">How Persistent Storage Works</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/volumes-and-storage/attaching-existing-storage/" class="">Setting up Existing Storage</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/volumes-and-storage/provisioning-new-storage/" class="">Dynamically Provisioning New Storage in Rancher</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/volumes-and-storage/examples/" class="">Provisioning Storage Examples<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/volumes-and-storage/examples/ebs/" class="">Creating Persistent Storage in Amazon&#39;s EBS</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/volumes-and-storage/examples/nfs/" class="">NFS Storage</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/volumes-and-storage/examples/vsphere/" class="">vSphere Storage</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/volumes-and-storage/glusterfs-volumes/" class="">GlusterFS Volumes</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/volumes-and-storage/iscsi-volumes/" class="">iSCSI Volumes</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/projects-and-namespaces/" class="">Projects and Kubernetes Namespaces with Rancher</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/" class="">Tools for Logging, Monitoring, and Visibility<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/notifiers/" class="">Notifiers</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/alerts/" class="">Alerts<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/alerts/default-alerts/" class="">Default Alerts for Cluster Monitoring</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/logging/" class="">Rancher Integration with Logging Services<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/logging/elasticsearch/" class="">Elasticsearch</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/logging/splunk/" class="">Splunk</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/logging/kafka/" class="">Kafka</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/logging/syslog/" class="">Syslog</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/logging/fluentd/" class="">Fluentd</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/monitoring/" class="">Integrating Rancher and Prometheus for Cluster Monitoring<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/monitoring/prometheus/" class="">Prometheus Configuration</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/monitoring/viewing-metrics/" class="">Viewing Metrics</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/monitoring/cluster-metrics/" class="">Cluster Metrics</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/monitoring/expression/" class="">Expression</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/" class="">Istio<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/resources/" class="">CPU and Memory Allocations</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/setup/" class="">Setup Guide<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/setup/enable-istio-in-cluster/" class="">1. Enable Istio in the Cluster<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/setup/enable-istio-in-cluster/enable-istio-with-psp/" class="">Enable Istio with Pod Security Policies</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/setup/enable-istio-in-namespace/" class="">2. Enable Istio in a Namespace</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/setup/node-selectors/" class="">3. Select the Nodes Where Istio Components Will be Deployed</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/setup/deploy-workloads/" class="">4. Add Deployments and Services with the Istio Sidecar</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/setup/gateway/" class="">5. Set up the Istio Gateway</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/setup/set-up-traffic-management/" class="">6. Set up Istio&#39;s Components for Traffic Management</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/setup/view-traffic/" class="">7. Generate and View Traffic</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/rbac/" class="">Role-based Access Control</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/tools/istio/disabling-istio/" class="">Disabling Istio</a>
        </li>
</ul></li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/cloning-clusters/" class="">Cloning Clusters</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/certificate-rotation/" class="">Certificate Rotation</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/backing-up-etcd/" class="">Backing up etcd</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/restoring-etcd/" class="">Restoring etcd</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cluster-admin/cleaning-cluster-nodes/" class="">Removing Kubernetes Components from Nodes</a>
        </li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/" class="">Project Administration<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/project-members/" class="">Adding Users to Projects</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/resource-quotas/" class="">Project Resource Quotas<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/resource-quotas/quotas-for-projects/" class="">How Resource Quotas Work in Rancher Projects</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/resource-quotas/override-namespace-default/" class="">Overriding the Default Limit for a Namespace</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/resource-quotas/override-container-default/" class="">Setting Container Default Resource Limits</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/resource-quotas/quota-type-reference/" class="">Resource Quota Type Reference</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/namespaces/" class="">Namespaces</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/tools/" class="">Tools for Logging, Monitoring, and Visibility<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/tools/alerts/" class="">Alerts</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/tools/logging/" class="">Logging</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/tools/monitoring/" class="">Monitoring</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/istio/" class="">Istio</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/pipelines/" class="">Rancher&#39;s CI/CD Pipelines<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/pipelines/docs-for-v2.0.x/" class="">v2.0.x Pipeline Documentation</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/project-admin/pod-security-policies/" class="">Pod Security Policies</a>
        </li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/" class="">Kubernetes Resources, Registries and Pipelines<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/workloads/" class="">Kubernetes Workloads and Pods<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/workloads/deploy-workloads/" class="">Deploying Workloads</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/workloads/rollback-workloads/" class="">Rolling Back Workloads</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/workloads/upgrade-workloads/" class="">Upgrading Workloads</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/workloads/add-a-sidecar/" class="">Adding a Sidecar</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/horitzontal-pod-autoscaler/" class="">The Horizontal Pod Autoscaler<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/horitzontal-pod-autoscaler/hpa-background/" class="">Background Information on HPAs</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/horitzontal-pod-autoscaler/manage-hpa-with-rancher-ui/" class="">Managing HPAs with the Rancher UI</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/horitzontal-pod-autoscaler/manage-hpa-with-kubectl/" class="">Managing HPAs with kubectl</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/horitzontal-pod-autoscaler/testing-hpa/" class="">Testing HPAs with kubectl</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/horitzontal-pod-autoscaler/hpa-for-rancher-before-2_0_7/" class="">Manual HPA Installation for Clusters Created Before Rancher v2.0.7</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/load-balancers-and-ingress/" class="">Set Up Load Balancer and Ingress Controller within Rancher<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/load-balancers-and-ingress/load-balancers/" class="">Layer 4 and Layer 7 Load Balancing</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/load-balancers-and-ingress/ingress/" class="">Adding Ingresses to Your Project</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/service-discovery/" class="">Service Discovery</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/pipelines/" class="">Pipelines<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/pipelines/example-repos/" class="">Example Repositories</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/pipelines/example/" class="">Example YAML File</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/certificates/" class="">Encrypting HTTP Communication</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/configmaps/" class="">ConfigMaps</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/secrets/" class="">Secrets</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/k8s-in-rancher/registries/" class="">Kubernetes Registry and Docker Registry</a>
        </li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/catalog/" class="">Catalogs, Helm Charts and Apps<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/catalog/built-in/" class="">Built-in Global Catalogs</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/catalog/custom/" class="">Custom Catalogs<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/catalog/custom/creating/" class="">Creating Custom Catalogs Apps</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/catalog/custom/adding/" class="">Adding Custom Catalogs</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/catalog/multi-cluster-apps/" class="">Multi-Cluster Apps</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/catalog/apps/" class="">Apps in a Project</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/catalog/globaldns/" class="">Global DNS</a>
        </li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/cli/" class="">Using the Rancher Command Line Interface</a>
        </li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/system-tools/" class="">System Tools</a>
        </li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/user-settings/" class="">User Settings<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/user-settings/api-keys/" class="">API Keys</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/user-settings/node-templates/" class="">Managing Node Templates</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/user-settings/cloud-credentials/" class="">Managing Cloud Credentials</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/user-settings/preferences/" class="">User Preferences</a>
        </li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/api/" class="">API<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/api/api-tokens/" class="">API Tokens</a>
        </li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/security/" class="submenu-indicator-minus">Security<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap ">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/security/security-scan/" class="">Security Scans</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/security/hardening-2.3.5/" class="">Hardening Guide v2.3.5</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/security/hardening-2.3.3/" class="">Hardening Guide v2.3.3</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/security/hardening-2.3/" class="">Hardening Guide v2.3</a>
        </li>

  <li class="tree-nav-item active">
        <a href="/docs/rancher/v2.x/en/security/hardening-2.2/" class="submenu-indicator-minus">Hardening Guide v2.2</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/security/hardening-2.1/" class="">Hardening Guide v2.1</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/security/benchmark-2.3.5/" class="">CIS Benchmark Rancher Self-Assessment Guide - v2.3.5</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/security/benchmark-2.3.3/" class="">CIS Benchmark Rancher Self-Assessment Guide - Rancher v2.3.3</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/security/benchmark-2.3/" class="">CIS Benchmark Rancher Self-Assessment Guide v2.3</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/security/benchmark-2.2/" class="">CIS Benchmark Rancher Self-Assessment Guide v2.2</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/security/benchmark-2.1/" class="">CIS Benchmark Rancher Self-Assessment Guide v2.1</a>
        </li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/faq/" class="">FAQ<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/faq/upgrades-to-2x/" class="">Questions about Upgrading to Rancher v2.x</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/faq/kubectl/" class="">Installing and Configuring kubectl</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/faq/networking/" class="">Networking<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/faq/networking/cni-providers/" class="">Container Network Interface (CNI) Providers</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/faq/technical/" class="">Technical</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/faq/security/" class="">Security</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/faq/telemetry/" class="">Telemetry</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/faq/removing-rancher/" class="">Rancher is No Longer Needed</a>
        </li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/troubleshooting/" class="">Troubleshooting<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/troubleshooting/kubernetes-components/" class="">Kubernetes Components<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/troubleshooting/kubernetes-components/etcd/" class="">Troubleshooting etcd Nodes</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/troubleshooting/kubernetes-components/controlplane/" class="">Troubleshooting Controlplane Nodes</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/troubleshooting/kubernetes-components/nginx-proxy/" class="">Troubleshooting nginx-proxy</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/troubleshooting/kubernetes-components/worker-and-generic/" class="">Troubleshooting Worker Nodes and Generic Components</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/troubleshooting/kubernetes-resources/" class="">Kubernetes resources</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/troubleshooting/networking/" class="">Networking</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/troubleshooting/dns/" class="">DNS</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/troubleshooting/rancherha/" class="">Rancher HA</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/troubleshooting/imported-clusters/" class="">Imported clusters</a>
        </li>
</ul></li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/contributing/" class="">Contributing to Rancher</a>
        </li>

    
      
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/v1.6-migration/" class="">Migrating from v1.6 to v2.x<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/v1.6-migration/kub-intro/" class="">Kubernetes Introduction</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/v1.6-migration/get-started/" class="">1. Get Started</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/v1.6-migration/run-migration-tool/" class="">2. Migrate Your Services<span class="submenu-indicator">
              <span class="object1"></span>
              <span class="object2"></span>
              <span class="object3"></span>
            </span></a>
        
        <ul class="tree-nav-sublist submenu submenus-wrap hide">
  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/v1.6-migration/run-migration-tool/migration-tools-ref/" class="">Migration Tools CLI Reference</a>
        </li>
</ul></li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/v1.6-migration/expose-services/" class="">3. Expose Your Services</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/v1.6-migration/monitor-apps/" class="">4. Configure Health Checks</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/v1.6-migration/schedule-workloads/" class="">5. Schedule Your Services</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/v1.6-migration/discover-services/" class="">6. Service Discovery</a>
        </li>

  <li class="tree-nav-item ">
        <a href="/docs/rancher/v2.x/en/v1.6-migration/load-balancing/" class="">7. Load Balancing</a>
        </li>
</ul></li>

    
  </ul>
</div>



        
      </div>
      <div class="
        col-xl-9
        col-lg-8
        col-md-8
        col-sm-12
        col-xs-12
        col-12
        texts-container">
        <div class="docs-wrap">
            
            <h1 class="m-t-0">Hardening Guide v2.2</h1>
            <hr/>
          

          

          <div class="main-content docs-body">
            
            
            
            

<p>This document provides prescriptive guidance for hardening a production installation of Rancher v2.2.x. It outlines the configurations and controls required to address Kubernetes benchmark controls from the Center for Information Security (CIS).</p>

<blockquote>
<p>This hardening guide describes how to secure the nodes in your cluster, and it is recommended to follow this guide before installing Kubernetes.</p>
</blockquote>

<p>This hardening guide is intended to be used with specific versions of the CIS Kubernetes Benchmark, Kubernetes, and Rancher:</p>

<table>
<thead>
<tr>
<th>Hardening Guide Version</th>
<th>Rancher Version</th>
<th>CIS Benchmark Version</th>
<th>Kubernetes Version</th>
</tr>
</thead>

<tbody>
<tr>
<td>Hardening Guide v2.2</td>
<td>Rancher v2.2.x</td>
<td>Benchmark v1.4.1, 1.4.0</td>
<td>Kubernetes 1.13</td>
</tr>
</tbody>
</table>

<p><a href="https://releases.rancher.com/documents/security/2.2.x/Rancher_Hardening_Guide.pdf">Click here to download a PDF version of this document</a></p>

<p>For more detail about evaluating a hardened cluster against the official CIS benchmark, refer to the <a href="http://jijeesh.github.io/docs/rancher/v2.x/en/security/benchmark-2.2/">CIS Benchmark Rancher Self-Assessment Guide - Rancher v2.2.x</a>.</p>

<h3 id="profile-definitions">Profile Definitions</h3>

<p>The following profile definitions agree with the CIS benchmarks for Kubernetes.</p>

<p>A profile is a set of configurations that provide a certain amount of hardening. Generally, the more hardened an environment is, the more it affects performance.</p>

<h4 id="level-1">Level 1</h4>

<p>Items in this profile intend to:</p>

<ul>
<li>offer practical advice appropriate for the environment;</li>
<li>deliver an obvious security benefit; and</li>
<li>not alter the functionality or utility of the environment beyond an acceptable margin</li>
</ul>

<h4 id="level-2">Level 2</h4>

<p>Items in this profile extend the “Level 1” profile and exhibit one or more of the following characteristics:</p>

<ul>
<li>are intended for use in environments or use cases where security is paramount</li>
<li>act as a defense in depth measure</li>
<li>may negatively impact the utility or performance of the technology</li>
</ul>

<hr />

<h2 id="1-1-rancher-ha-kubernetes-cluster-host-configuration">1.1 - Rancher HA Kubernetes cluster host configuration</h2>

<h3 id="1-1-1-configure-default-sysctl-settings-on-all-hosts">1.1.1 - Configure default sysctl settings on all hosts</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>Configure sysctl settings to match what the kubelet would set if allowed.</p>

<p><strong>Rationale</strong></p>

<p>We recommend that users launch the kubelet with the <code>--protect-kernel-defaults</code> option. The settings that the kubelet initially attempts to change can be set manually.</p>

<p>This supports the following control:</p>

<ul>
<li>2.1.7 - Ensure that the <code>--protect-kernel-defaults</code> argument is set to true (Scored)</li>
</ul>

<p><strong>Audit</strong></p>

<ul>
<li>Verify <code>vm.overcommit_memory = 1</code></li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sysctl vm.overcommit_memory</code></pre></div>
<ul>
<li>Verify <code>kernel.panic = 10</code></li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sysctl kernel.panic</code></pre></div>
<ul>
<li>Verify <code>kernel.panic_on_oops = 1</code></li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sysctl kernel.panic_on_oops</code></pre></div>
<p><strong>Remediation</strong></p>

<ul>
<li>Set the following parameters in <code>/etc/sysctl.conf</code> on all nodes:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">vm.overcommit_memory=1
kernel.panic=10
kernel.panic_on_oops=1</code></pre></div>
<ul>
<li>Run <code>sysctl -p</code> to enable the settings.</li>
</ul>

<h3 id="1-1-2-install-the-encryption-provider-configuration-on-all-control-plane-nodes">1.1.2 - Install the encryption provider configuration on all control plane nodes</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>Create a Kubernetes encryption configuration file on each of the RKE nodes that will be provisioned with the <code>controlplane</code> role:</p>

<p><strong>NOTE:</strong> The <code>--experimental-encryption-provider-config</code> flag in Kubernetes 1.13+ is actually <code>--encryption-provider-config</code></p>

<p><strong>Rationale</strong></p>

<p>This configuration file will ensure that the Rancher RKE cluster encrypts secrets at rest, which Kubernetes does not do by default.</p>

<p>This supports the following controls:</p>

<ul>
<li>1.1.34 - Ensure that the <code>--experimental-encryption-provider-config</code> argument is set as appropriate (Scored)</li>
<li>1.1.35 - Ensure that the encryption provider is set to <code>aescbc</code> (Scored)</li>
</ul>

<p><strong>Audit</strong></p>

<p>On the control plane hosts for the Rancher HA cluster run:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">stat /opt/kubernetes/encryption.yaml</code></pre></div>
<p>Ensure that:</p>

<ul>
<li>The file is present</li>
<li>The file mode is <code>0600</code></li>
<li>The file owner is <code>root:root</code></li>
<li>The file contains:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#666"> </span>apiserver.config.k8s.io/v1<span style="color:#666">
</span><span style="color:#666"></span>kind:<span style="color:#666"> </span>EncryptionConfiguration<span style="color:#666">
</span><span style="color:#666"></span>resources:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>resources:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>secrets<span style="color:#666">
</span><span style="color:#666">    </span>providers:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>aescbc:<span style="color:#666">
</span><span style="color:#666">        </span>keys:<span style="color:#666">
</span><span style="color:#666">        </span>-<span style="color:#666"> </span>name:<span style="color:#666"> </span>key1<span style="color:#666">
</span><span style="color:#666">          </span>secret:<span style="color:#666"> </span>&lt;<span style="color:#3677a9">32</span>-byte<span style="color:#666"> </span>base64<span style="color:#666"> </span>encoded<span style="color:#666"> </span>string<span style="color:#ed9d13">&gt;
</span><span style="color:#ed9d13">    - identity: {}</span></code></pre></div>
<p>Where <code>aescbc</code> is the key type, and <code>secret</code> is populated with a 32-byte base64 encoded string.</p>

<p><strong>Remediation</strong></p>

<ul>
<li>Generate a key and an empty configuration file:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">head -c <span style="color:#3677a9">32</span> /dev/urandom | base64 -i -
touch /opt/kubernetes/encryption.yaml</code></pre></div>
<ul>
<li>Set the file ownership to <code>root:root</code> and the permissions to <code>0600</code></li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">chown root:root /opt/kubernetes/encryption.yaml
chmod <span style="color:#3677a9">0600</span> /opt/kubernetes/encryption.yaml</code></pre></div>
<ul>
<li>Set the contents to:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#666"> </span>v1<span style="color:#666">
</span><span style="color:#666"></span>kind:<span style="color:#666"> </span>EncryptionConfig<span style="color:#666">
</span><span style="color:#666"></span>resources:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>resources:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>secrets<span style="color:#666">
</span><span style="color:#666">    </span>providers:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>aescbc:<span style="color:#666">
</span><span style="color:#666">        </span>keys:<span style="color:#666">
</span><span style="color:#666">        </span>-<span style="color:#666"> </span>name:<span style="color:#666"> </span>key1<span style="color:#666">
</span><span style="color:#666">          </span>secret:<span style="color:#666"> </span>&lt;<span style="color:#3677a9">32</span>-byte<span style="color:#666"> </span>base64<span style="color:#666"> </span>encoded<span style="color:#666"> </span>string<span style="color:#ed9d13">&gt;
</span><span style="color:#ed9d13">    - identity: {}</span></code></pre></div>
<p>Where <code>secret</code> is the 32-byte base64-encoded string generated in the first step.</p>

<p><strong>NOTE:</strong></p>

<p>Files that are placed in <code>/opt/kubernetes</code> need to be mounted in using the <code>extra_binds</code> functionality in RKE.</p>

<h3 id="1-1-3-install-the-audit-log-configuration-on-all-control-plane-nodes">1.1.3 - Install the audit log configuration on all control plane nodes.</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>Place the configuration file for Kubernetes audit logging on each of the control plane nodes in the cluster.</p>

<p><strong>Rationale</strong></p>

<p>The Kubernetes API has audit logging capability that is the best way to track actions in the cluster.</p>

<p>This supports the following controls:</p>

<ul>
<li>1.1.15 - Ensure that the <code>--audit-log-path</code> argument is set as appropriate (Scored)</li>
<li>1.1.16 - Ensure that the <code>--audit-log-maxage</code> argument is as appropriate (Scored)</li>
<li>1.1.17 - Ensure that the <code>--audit-log-maxbackup</code> argument is set as appropriate (Scored)</li>
<li>1.1.18 - Ensure that the <code>--audit-log-maxsize</code> argument is set as appropriate (Scored)</li>
<li>1.1.37 - Ensure that the <code>AdvancedAuditing</code> argument is not set to false (Scored)</li>
</ul>

<p><strong>Audit</strong></p>

<p>On each control plane node, run:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">stat /opt/kubernetes/audit.yaml</code></pre></div>
<p>Ensure that:</p>

<ul>
<li>The file is present</li>
<li>The file mode is <code>0600</code></li>
<li>The file owner is <code>root:root</code></li>
<li>The file contains:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#666"> </span>audit.k8s.io/v1beta1<span style="color:#666">
</span><span style="color:#666"></span>kind:<span style="color:#666"> </span>Policy<span style="color:#666">
</span><span style="color:#666"></span>rules:<span style="color:#666">
</span><span style="color:#666"></span>-<span style="color:#666"> </span>level:<span style="color:#666"> </span>Metadata</code></pre></div>
<p><strong>Remediation</strong></p>

<p>On nodes with the <code>controlplane</code> role:</p>

<ul>
<li>Generate an empty configuration file:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">touch /opt/kubernetes/audit.yaml</code></pre></div>
<ul>
<li>Set the file ownership to <code>root:root</code> and the permissions to <code>0600</code></li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">chown root:root /opt/kubernetes/audit.yaml
chmod <span style="color:#3677a9">0600</span> /opt/kubernetes/audit.yaml</code></pre></div>
<ul>
<li>Set the contents to:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#666"> </span>audit.k8s.io/v1beta1<span style="color:#666">
</span><span style="color:#666"></span>kind:<span style="color:#666"> </span>Policy<span style="color:#666">
</span><span style="color:#666"></span>rules:<span style="color:#666">
</span><span style="color:#666"></span>-<span style="color:#666"> </span>level:<span style="color:#666"> </span>Metadata</code></pre></div>
<p><strong>NOTE:</strong></p>

<p>Files that are placed in <code>/opt/kubernetes</code> need to be mounted in using the <code>extra_binds</code> functionality in RKE.</p>

<h3 id="1-1-4-place-kubernetes-event-limit-configuration-on-each-control-plane-host">1.1.4 - Place Kubernetes event limit configuration on each control plane host</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>Place the configuration file for Kubernetes event limit configuration on each of the control plane nodes in the cluster.</p>

<p><strong>Rationale</strong></p>

<p>Set up the <code>EventRateLimit</code> admission control plugin to prevent clients from overwhelming the API server. The settings below are intended as an initial value and may need to be adjusted for larger clusters.</p>

<p>This supports the following control:</p>

<ul>
<li>1.1.36 - Ensure that the admission control plugin <code>EventRateLimit</code> is set (Scored)</li>
</ul>

<p><strong>Audit</strong></p>

<p>On nodes with the <code>controlplane</code> role run:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">stat /opt/kubernetes/admission.yaml
stat /opt/kubernetes/event.yaml</code></pre></div>
<p>For each file, ensure that:</p>

<ul>
<li>The file is present</li>
<li>The file mode is <code>0600</code></li>
<li>The file owner is <code>root:root</code></li>
</ul>

<p>For <code>admission.yaml</code> ensure that the file contains:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#666"> </span>apiserver.k8s.io/v1alpha1<span style="color:#666">
</span><span style="color:#666"></span>kind:<span style="color:#666"> </span>AdmissionConfiguration<span style="color:#666">
</span><span style="color:#666"></span>plugins:<span style="color:#666">
</span><span style="color:#666"></span>-<span style="color:#666"> </span>name:<span style="color:#666"> </span>EventRateLimit<span style="color:#666">
</span><span style="color:#666">  </span>path:<span style="color:#666"> </span>/opt/kubernetes/event.yaml</code></pre></div>
<p>For <code>event.yaml</code> ensure that the file contains:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#666"> </span>eventratelimit.admission.k8s.io/v1alpha1<span style="color:#666">
</span><span style="color:#666"></span>kind:<span style="color:#666"> </span>Configuration<span style="color:#666">
</span><span style="color:#666"></span>limits:<span style="color:#666">
</span><span style="color:#666"></span>-<span style="color:#666"> </span>type:<span style="color:#666"> </span>Server<span style="color:#666">
</span><span style="color:#666">  </span>qps:<span style="color:#666"> </span><span style="color:#3677a9">5000</span><span style="color:#666">
</span><span style="color:#666">  </span>burst:<span style="color:#666"> </span><span style="color:#3677a9">20000</span></code></pre></div>
<p><strong>Remediation</strong></p>

<p>On nodes with the <code>controlplane</code> role:</p>

<ul>
<li>Generate an empty configuration file:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">touch /opt/kubernetes/admission.yaml
touch /opt/kubernetes/event.yaml</code></pre></div>
<ul>
<li>Set the file ownership to <code>root:root</code> and the permissions to <code>0600</code></li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">chown root:root /opt/kubernetes/admission.yaml
chown root:root /opt/kubernetes/event.yaml
chmod <span style="color:#3677a9">0600</span> /opt/kubernetes/admission.yaml
chmod <span style="color:#3677a9">0600</span> /opt/kubernetes/event.yaml</code></pre></div>
<ul>
<li>For <code>admission.yaml</code> set the contents to:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#666"> </span>apiserver.k8s.io/v1alpha1<span style="color:#666">
</span><span style="color:#666"></span>kind:<span style="color:#666"> </span>AdmissionConfiguration<span style="color:#666">
</span><span style="color:#666"></span>plugins:<span style="color:#666">
</span><span style="color:#666"></span>-<span style="color:#666"> </span>name:<span style="color:#666"> </span>EventRateLimit<span style="color:#666">
</span><span style="color:#666">  </span>path:<span style="color:#666"> </span>/opt/kubernetes/event.yaml</code></pre></div>
<ul>
<li>For <code>event.yaml</code> set the contents to:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#666"> </span>eventratelimit.admission.k8s.io/v1alpha1<span style="color:#666">
</span><span style="color:#666"></span>kind:<span style="color:#666"> </span>Configuration<span style="color:#666">
</span><span style="color:#666"></span>limits:<span style="color:#666">
</span><span style="color:#666"></span>-<span style="color:#666"> </span>type:<span style="color:#666"> </span>Server<span style="color:#666">
</span><span style="color:#666">  </span>qps:<span style="color:#666"> </span><span style="color:#3677a9">5000</span><span style="color:#666">
</span><span style="color:#666">  </span>burst:<span style="color:#666"> </span><span style="color:#3677a9">20000</span></code></pre></div>
<p><strong>NOTE:</strong></p>

<p>Files that are placed in <code>/opt/kubernetes</code> need to be mounted in using the <code>extra_binds</code> functionality in RKE.</p>

<h2 id="2-1-rancher-ha-kubernetes-cluster-configuration-via-rke">2.1 - Rancher HA Kubernetes Cluster Configuration via RKE</h2>

<p>(See Appendix A. for full RKE <code>cluster.yml</code> example)</p>

<h3 id="2-1-1-configure-kubelet-options">2.1.1 - Configure kubelet options</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>Ensure Kubelet options are configured to match CIS controls.</p>

<p><strong>Rationale</strong></p>

<p>To pass the following controls in the CIS benchmark, ensure the appropriate flags are passed to the Kubelet.</p>

<ul>
<li>2.1.1 -  Ensure that the <code>--anonymous-auth</code> argument is set to false (Scored)</li>
<li>2.1.2 - Ensure that the <code>--authorization-mode</code> argument is not set to <code>AlwaysAllow</code> (Scored)</li>
<li>2.1.6 - Ensure that the <code>--streaming-connection-idle-timeout</code> argument is not set to 0 (Scored)</li>
<li>2.1.7 - Ensure that the <code>--protect-kernel-defaults</code> argument is set to true (Scored)</li>
<li>2.1.8 - Ensure that the <code>--make-iptables-util-chains</code> argument is set to true (Scored)</li>
<li>2.1.10 - Ensure that the <code>--event-qps</code> argument is set to 0 (Scored)</li>
<li>2.1.13 - Ensure that the <code>RotateKubeletServerCertificate</code> argument is set to true (Scored)</li>
<li>2.1.14 - Ensure that the Kubelet only makes use of Strong Cryptographic Ciphers (Not Scored)</li>
</ul>

<p><strong>Audit</strong></p>

<p>Inspect the Kubelet containers on all hosts and verify that they are running with the following options:</p>

<ul>
<li><code>--streaming-connection-idle-timeout=&lt;duration greater than 0&gt;</code></li>
<li><code>--authorization-mode=Webhook</code></li>
<li><code>--protect-kernel-defaults=true</code></li>
<li><code>--make-iptables-util-chains=true</code></li>
<li><code>--event-qps=0</code></li>
<li><code>--anonymous-auth=false</code></li>
<li><code>--feature-gates=&quot;RotateKubeletServerCertificate=true&quot;</code></li>
<li><code>--tls-cipher-suites=&quot;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256&quot;</code></li>
</ul>

<p><strong>Remediation</strong></p>

<ul>
<li>Add the following to the RKE <code>cluster.yml</code> kubelet section under <code>services</code>:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">services:<span style="color:#666">
</span><span style="color:#666">  </span>kubelet:<span style="color:#666">
</span><span style="color:#666">    </span>extra_args:<span style="color:#666">
</span><span style="color:#666">      </span>authorization-mode:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;Webhook&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>streaming-connection-idle-timeout:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;&lt;duration&gt;&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>protect-kernel-defaults:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;true&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>make-iptables-util-chains:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;true&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>event-qps:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;0&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>anonymous-auth:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;false&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>feature-gates:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;RotateKubeletServerCertificate=true&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>tls-cipher-suites:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256&#34;</span></code></pre></div>
<p>Where <code>&lt;duration&gt;</code> is in a form like <code>1800s</code>.</p>

<ul>
<li>Reconfigure the cluster:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rke up --config cluster.yml</code></pre></div>
<h3 id="2-1-2-configure-kube-api-options">2.1.2 - Configure kube-api options</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>Ensure the RKE configuration is set to deploy the <code>kube-api</code> service with the options required for controls.</p>

<p><strong>NOTE:</strong></p>

<p>Enabling the <code>AlwaysPullImages</code> admission control plugin can cause degraded performance due to overhead of always pulling images.
Enabling the <code>DenyEscalatingExec</code> admission control plugin will prevent the &lsquo;Launch kubectl&rsquo; functionality in the UI from working.</p>

<p><strong>Rationale</strong></p>

<p>To pass the following controls for the kube-api server ensure RKE configuration passes the appropriate options.</p>

<ul>
<li>1.1.1 - Ensure that the <code>--anonymous-auth</code> argument is set to false (Scored)</li>
<li>1.1.8 - Ensure that the <code>--profiling argument</code> is set to false (Scored)</li>
<li>1.1.11 - Ensure that the admission control plugin <code>AlwaysPullImages</code> is set (Scored)</li>
<li>1.1.12 - Ensure that the admission control plugin <code>DenyEscalatingExec</code> is set (Scored)</li>
<li>1.1.14 - Ensure that the admission control plugin <code>NamespaceLifecycle</code> is set (Scored)</li>
<li>1.1.15 - Ensure that the <code>--audit-log-path</code> argument is set as appropriate (Scored)</li>
<li>1.1.16 - Ensure that the <code>--audit-log-maxage</code> argument is set as appropriate (Scored)</li>
<li>1.1.17 - Ensure that the <code>--audit-log-maxbackup</code> argument is set as appropriate (Scored)</li>
<li>1.1.18 - Ensure that the <code>--audit-log-maxsize</code> argument is set as appropriate (Scored)</li>
<li>1.1.23 - Ensure that the <code>--service-account-lookup</code> argument is set to true (Scored)</li>
<li>1.1.24 - Ensure that the admission control plugin <code>PodSecurityPolicy</code> is set (Scored)</li>
<li>1.1.30 Ensure that the API Server only makes use of Strong Cryptographic Ciphers (Not Scored)</li>
<li>1.1.34 - Ensure that the <code>--experimental-encryption-provider-config</code> argument is set as appropriate (Scored)</li>
<li>1.1.35 - Ensure that the encryption provider is set to <code>aescbc</code> (Scored)</li>
<li>1.1.36 - Ensure that the admission control plugin <code>EventRateLimit</code> is set (Scored)</li>
<li>1.1.37 - Ensure that the <code>AdvancedAuditing</code> argument is not set to <code>false</code> (Scored)</li>
</ul>

<p><strong>Audit</strong></p>

<ul>
<li>On nodes with the <code>controlplane</code> role inspect the <code>kube-apiserver</code> containers:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  docker inspect kube-apiserver</code></pre></div>
<ul>
<li>Look for the following options in the command section of the output:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">--anonymous-auth=false
--profiling=false
--service-account-lookup=true
--enable-admission-plugins= &#34;ServiceAccount,NamespaceLifecycle,LimitRanger,PersistentVolumeLabel,DefaultStorageClass,ResourceQuota,DefaultTolerationSeconds,AlwaysPullImages,DenyEscalatingExec,NodeRestriction,EventRateLimit,PodSecurityPolicy&#34;
--encryption-provider-config=/opt/kubernetes/encryption.yaml
--admission-control-config-file=/opt/kubernetes/admission.yaml
--audit-log-path=/var/log/kube-audit/audit-log.json
--audit-log-maxage=5
--audit-log-maxbackup=5
--audit-log-maxsize=100
--audit-log-format=json
--audit-policy-file=/opt/kubernetes/audit.yaml
--tls-cipher-suites: &#34;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256&#34;</code></pre></div>
<ul>
<li>In the <code>volume</code> section of the output ensure the bind mount is present:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">/var/log/kube-audit:/var/log/kube-audit</code></pre></div>
<p><strong>Remediation</strong></p>

<ul>
<li>In the RKE <code>cluster.yml</code> add the following directives to the <code>kube-api</code> section under <code>services</code>:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">services:<span style="color:#666">
</span><span style="color:#666">  </span>kube-api:<span style="color:#666">
</span><span style="color:#666">    </span>pod_security_policy:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">true</span><span style="color:#666">
</span><span style="color:#666">    </span>extra_args:<span style="color:#666">
</span><span style="color:#666">      </span>anonymous-auth:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;false&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>profiling:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;false&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>service-account-lookup:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;true&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>enable-admission-plugins:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;ServiceAccount,NamespaceLifecycle,LimitRanger,PersistentVolumeLabel,DefaultStorageClass,ResourceQuota,DefaultTolerationSeconds,AlwaysPullImages,DenyEscalatingExec,NodeRestriction,EventRateLimit,PodSecurityPolicy&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>encryption-provider-config:<span style="color:#666"> </span>/opt/kubernetes/encryption.yaml<span style="color:#666">
</span><span style="color:#666">      </span>admission-control-config-file:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;/opt/kubernetes/admission.yaml&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>audit-log-path:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;/var/log/kube-audit/audit-log.json&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>audit-log-maxage:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;5&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>audit-log-maxbackup:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;5&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>audit-log-maxsize:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;100&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>audit-log-format:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;json&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>audit-policy-file:<span style="color:#666"> </span>/opt/kubernetes/audit.yaml<span style="color:#666">
</span><span style="color:#666">      </span>tls-cipher-suites:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256&#34;</span><span style="color:#666">
</span><span style="color:#666">    </span>extra_binds:<span style="color:#666">
</span><span style="color:#666">      </span>-<span style="color:#666"> </span><span style="color:#ed9d13">&#34;/var/log/kube-audit:/var/log/kube-audit&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>-<span style="color:#666"> </span><span style="color:#ed9d13">&#34;/opt/kubernetes:/opt/kubernetes&#34;</span></code></pre></div>
<ul>
<li>Reconfigure the cluster:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rke up --config cluster.yml</code></pre></div>
<p><strong>NOTE:</strong></p>

<p>Files that are placed in <code>/opt/kubernetes</code> need to be mounted in using the <code>extra_binds</code> functionality in RKE.</p>

<h3 id="2-1-3-configure-scheduler-options">2.1.3 - Configure scheduler options</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>Set the appropriate options for the Kubernetes scheduling service.</p>

<p><strong>NOTE:</strong> Setting <code>--address</code> to <code>127.0.0.1</code> will prevent Rancher cluster monitoring from scraping this endpoint.</p>

<p><strong>Rationale</strong></p>

<p>To address the following controls on the CIS benchmark, the command line options should be set on the Kubernetes scheduler.</p>

<ul>
<li>1.2.1 - Ensure that the <code>--profiling</code> argument is set to <code>false</code> (Scored)</li>
<li>1.2.2 - Ensure that the <code>--address</code> argument is set to <code>127.0.0.1</code> (Scored)</li>
</ul>

<p><strong>Audit</strong></p>

<ul>
<li>On nodes with the <code>controlplane</code> role: inspect the <code>kube-scheduler</code> containers:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker inspect kube-scheduler</code></pre></div>
<ul>
<li>Verify the following options are set in the <code>command</code> section.</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">--profiling=false
--address=127.0.0.1</code></pre></div>
<p><strong>Remediation</strong></p>

<ul>
<li>In the RKE <code>cluster.yml</code> file ensure the following options are set:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">services:<span style="color:#666">
</span><span style="color:#666">  </span>…<span style="color:#666">
</span><span style="color:#666">  </span>scheduler:<span style="color:#666">
</span><span style="color:#666">    </span>extra_args:<span style="color:#666">
</span><span style="color:#666">    </span>profiling:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;false&#34;</span><span style="color:#666">
</span><span style="color:#666">    </span>address:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;127.0.0.1&#34;</span></code></pre></div>
<ul>
<li>Reconfigure the cluster:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rke up --config cluster.yml</code></pre></div>
<h3 id="2-1-4-configure-controller-options">2.1.4 - Configure controller options</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>Set the appropriate arguments on the Kubernetes controller manager.</p>

<p><strong>NOTE:</strong> Setting <code>--address</code> to <code>127.0.0.1</code> will prevent Rancher cluster monitoring from scraping this endpoint.</p>

<p><strong>Rationale</strong></p>

<p>To address the following controls the options need to be passed to the Kubernetes controller manager.</p>

<ul>
<li>1.3.1 - Ensure that the <code>--terminated-pod-gc-threshold</code> argument is set as appropriate (Scored)</li>
<li>1.3.2 - Ensure that the <code>--profiling</code> argument is set to false (Scored)</li>
<li>1.3.6 Ensure that the RotateKubeletServerCertificate argument is set to true (Scored)</li>
<li>1.3.7 - Ensure that the <code>--address</code> argument is set to 127.0.0.1 (Scored)</li>
</ul>

<p><strong>Audit</strong></p>

<ul>
<li>On nodes with the <code>controlplane</code> role inspect the <code>kube-controller-manager</code> container:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker inspect kube-controller-manager</code></pre></div>
<ul>
<li>Verify the following options are set in the <code>command</code> section:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">--terminated-pod-gc-threshold=1000
--profiling=false
--address=127.0.0.1
--feature-gates=&#34;RotateKubeletServerCertificate=true&#34;</code></pre></div>
<p><strong>Remediation</strong></p>

<ul>
<li>In the RKE <code>cluster.yml</code> file ensure the following options are set:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">services:<span style="color:#666">
</span><span style="color:#666">  </span>kube-controller:<span style="color:#666">
</span><span style="color:#666">    </span>extra_args:<span style="color:#666">
</span><span style="color:#666">      </span>profiling:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;false&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>address:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;127.0.0.1&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>terminated-pod-gc-threshold:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;1000&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>feature-gates:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;RotateKubeletServerCertificate=true&#34;</span></code></pre></div>
<ul>
<li>Reconfigure the cluster:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rke up --config cluster.yml</code></pre></div>
<h3 id="2-1-5-configure-addons-and-psps">2.1.5 - Configure addons and PSPs</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>Configure a restrictive pod security policy (PSP) as the default and create role bindings for system level services to use the less restrictive default PSP.</p>

<p><strong>Rationale</strong></p>

<p>To address the following controls, a restrictive default PSP needs to be applied as the default. Role bindings need to be in place to allow system services to still function.</p>

<ul>
<li>1.7.1 - Do not admit privileged containers (Not Scored)</li>
<li>1.7.2 - Do not admit containers wishing to share the host process ID namespace (Not Scored)</li>
<li>1.7.3 - Do not admit containers wishing to share the host IPC namespace (Not Scored)</li>
<li>1.7.4 - Do not admit containers wishing to share the host network namespace (Not Scored)</li>
<li>1.7.5 - Do not admit containers with <code>allowPrivilegeEscalation</code> (Not Scored)</li>
<li>1.7.6 - Do not admit root containers (Not Scored)</li>
<li>1.7.7 - Do not admit containers with dangerous capabilities (Not Scored)</li>
</ul>

<p><strong>Audit</strong></p>

<ul>
<li>Verify that the <code>cattle-system</code> namespace exists:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get ns |grep cattle</code></pre></div>
<ul>
<li>Verify that the roles exist:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get role default-psp-role -n ingress-nginx
kubectl get role default-psp-role -n cattle-system
kubectl get clusterrole psp:restricted</code></pre></div>
<ul>
<li>Verify the bindings are set correctly:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get rolebinding -n ingress-nginx default-psp-rolebinding
kubectl get rolebinding -n cattle-system default-psp-rolebinding
kubectl get clusterrolebinding psp:restricted</code></pre></div>
<ul>
<li>Verify the restricted PSP is present.</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get psp restricted</code></pre></div>
<p><strong>Remediation</strong></p>

<ul>
<li>In the RKE <code>cluster.yml</code> file ensure the following options are set:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">addons:<span style="color:#666"> </span><span style="color:#ed9d13">|
</span><span style="color:#ed9d13">  apiVersion: rbac.authorization.k8s.io/v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>Role<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>default-psp-role<span style="color:#666">
</span><span style="color:#666">    </span>namespace:<span style="color:#666"> </span>ingress-nginx<span style="color:#666">
</span><span style="color:#666">  </span>rules:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroups:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>extensions<span style="color:#666">
</span><span style="color:#666">    </span>resourceNames:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>default-psp<span style="color:#666">
</span><span style="color:#666">    </span>resources:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>podsecuritypolicies<span style="color:#666">
</span><span style="color:#666">    </span>verbs:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>use<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: rbac.authorization.k8s.io/v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>RoleBinding<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>default-psp-rolebinding<span style="color:#666">
</span><span style="color:#666">    </span>namespace:<span style="color:#666"> </span>ingress-nginx<span style="color:#666">
</span><span style="color:#666">  </span>roleRef:<span style="color:#666">
</span><span style="color:#666">    </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Role<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>default-psp-role<span style="color:#666">
</span><span style="color:#666">  </span>subjects:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Group<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>system:serviceaccounts<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Group<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>system:authenticated<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>Namespace<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>cattle-system<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: rbac.authorization.k8s.io/v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>Role<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>default-psp-role<span style="color:#666">
</span><span style="color:#666">    </span>namespace:<span style="color:#666"> </span>cattle-system<span style="color:#666">
</span><span style="color:#666">  </span>rules:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroups:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>extensions<span style="color:#666">
</span><span style="color:#666">    </span>resourceNames:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>default-psp<span style="color:#666">
</span><span style="color:#666">    </span>resources:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>podsecuritypolicies<span style="color:#666">
</span><span style="color:#666">    </span>verbs:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>use<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: rbac.authorization.k8s.io/v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>RoleBinding<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>default-psp-rolebinding<span style="color:#666">
</span><span style="color:#666">    </span>namespace:<span style="color:#666"> </span>cattle-system<span style="color:#666">
</span><span style="color:#666">  </span>roleRef:<span style="color:#666">
</span><span style="color:#666">    </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Role<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>default-psp-role<span style="color:#666">
</span><span style="color:#666">  </span>subjects:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Group<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>system:serviceaccounts<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Group<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>system:authenticated<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: extensions/v1beta1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>PodSecurityPolicy<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>restricted<span style="color:#666">
</span><span style="color:#666">  </span>spec:<span style="color:#666">
</span><span style="color:#666">    </span>requiredDropCapabilities:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>NET_RAW<span style="color:#666">
</span><span style="color:#666">    </span>privileged:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">false</span><span style="color:#666">
</span><span style="color:#666">    </span>allowPrivilegeEscalation:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">false</span><span style="color:#666">
</span><span style="color:#666">    </span>defaultAllowPrivilegeEscalation:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">false</span><span style="color:#666">
</span><span style="color:#666">    </span>fsGroup:<span style="color:#666">
</span><span style="color:#666">      </span>rule:<span style="color:#666"> </span>RunAsAny<span style="color:#666">
</span><span style="color:#666">    </span>runAsUser:<span style="color:#666">
</span><span style="color:#666">      </span>rule:<span style="color:#666"> </span>MustRunAsNonRoot<span style="color:#666">
</span><span style="color:#666">    </span>seLinux:<span style="color:#666">
</span><span style="color:#666">      </span>rule:<span style="color:#666"> </span>RunAsAny<span style="color:#666">
</span><span style="color:#666">    </span>supplementalGroups:<span style="color:#666">
</span><span style="color:#666">      </span>rule:<span style="color:#666"> </span>RunAsAny<span style="color:#666">
</span><span style="color:#666">    </span>volumes:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>emptyDir<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>secret<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>persistentVolumeClaim<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>downwardAPI<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>configMap<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>projected<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: rbac.authorization.k8s.io/v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>ClusterRole<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>psp:restricted<span style="color:#666">
</span><span style="color:#666">  </span>rules:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroups:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>extensions<span style="color:#666">
</span><span style="color:#666">    </span>resourceNames:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>restricted<span style="color:#666">
</span><span style="color:#666">    </span>resources:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>podsecuritypolicies<span style="color:#666">
</span><span style="color:#666">    </span>verbs:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>use<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: rbac.authorization.k8s.io/v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>ClusterRoleBinding<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>psp:restricted<span style="color:#666">
</span><span style="color:#666">  </span>roleRef:<span style="color:#666">
</span><span style="color:#666">    </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>ClusterRole<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>psp:restricted<span style="color:#666">
</span><span style="color:#666">  </span>subjects:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Group<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>system:serviceaccounts<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Group<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>system:authenticated</code></pre></div>
<ul>
<li>Reconfigure the cluster:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rke up --config cluster.yml</code></pre></div>
<h2 id="3-1-rancher-management-control-plane-installation">3.1 - Rancher Management Control Plane Installation</h2>

<h3 id="3-1-1-disable-the-local-cluster-option">3.1.1 - Disable the local cluster option</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 2</li>
</ul>

<p><strong>Description</strong></p>

<p>When deploying Rancher, disable the local cluster option on the Rancher Server.</p>

<p><strong>NOTE:</strong> This requires Rancher v2.1.2 or above.</p>

<p><strong>Rationale</strong></p>

<p>Having access to the local cluster from the Rancher UI is convenient for troubleshooting and debugging; however, if the local cluster is enabled in the Rancher UI, a user has access to all elements of the system, including the Rancher management server itself. Disabling the local cluster is a defense in depth measure and removes the possible attack vector from the Rancher UI and API.</p>

<p><strong>Audit</strong></p>

<ul>
<li>Verify the Rancher deployment has the <code>--add-local=false</code> option set.</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get deployment rancher -n cattle-system -o yaml |grep <span style="color:#ed9d13">&#39;add-local&#39;</span></code></pre></div>
<ul>
<li>In the Rancher UI go to <em>Clusters</em> in the <em>Global</em> view and verify that no <code>local</code> cluster is present.</li>
</ul>

<p><strong>Remediation</strong></p>

<ul>
<li>While upgrading or installing Rancher 2.2.x, provide the following flag:</li>
</ul>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">--set addLocal=&#34;false&#34;</code></pre></div>
<h3 id="3-1-2-enable-rancher-audit-logging">3.1.2 - Enable Rancher Audit logging</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>Enable Rancher’s built-in audit logging capability.</p>

<p><strong>Rationale</strong></p>

<p>Tracking down what actions were performed by users in Rancher can provide insight during post mortems, and if monitored proactively can be used to quickly detect malicious actions.</p>

<p><strong>Audit</strong></p>

<ul>
<li>Verify that the audit log parameters were passed into the Rancher deployment.</li>
</ul>

<pre><code>kubectl get deployment rancher -n cattle-system -o yaml | grep auditLog
</code></pre>

<ul>
<li><p>Verify that the log is going to the appropriate destination, as set by
<code>auditLog.destination</code></p>

<ul>
<li><code>sidecar</code>:</li>
</ul>

<ol>
<li><p>List pods:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get pods -n cattle-system</code></pre></div></li>

<li><p>Tail logs:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl logs &lt;pod&gt; -n cattle-system -c rancher-audit-log</code></pre></div></li>
</ol>

<ul>
<li><code>hostPath</code></li>
</ul>

<ol>
<li>On the worker nodes running the Rancher pods, verify that the log files are being written to the destination indicated in <code>auditlog.hostPath</code>.</li>
</ol></li>
</ul>

<p><strong>Remediation</strong></p>

<p>Upgrade the Rancher server installation using Helm, and configure the audit log settings. The instructions for doing so can be found in the reference section below.</p>

<h4 id="reference">Reference</h4>

<ul>
<li><a href="https://rancher.com/docs/rancher/v2.x/en/installation/options/chart-options/#advanced-options">https://rancher.com/docs/rancher/v2.x/en/installation/options/chart-options/#advanced-options</a></li>
</ul>

<h2 id="3-2-rancher-management-control-plane-authentication">3.2 - Rancher Management Control Plane Authentication</h2>

<h3 id="3-2-1-change-the-local-administrator-password-from-the-default-value">3.2.1 - Change the local administrator password from the default value</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>The local administrator password should be changed from the default.</p>

<p><strong>Rationale</strong></p>

<p>The default administrator password is common across all Rancher installations and should be changed immediately upon startup.</p>

<p><strong>Audit</strong></p>

<p>Attempt to login into the UI with the following credentials:
  - Username: admin
  - Password: admin</p>

<p>The login attempt must not succeed.</p>

<p><strong>Remediation</strong></p>

<p>Change the password from <code>admin</code> to a password that meets the recommended password standards for your organization.</p>

<h3 id="3-2-2-configure-an-identity-provider-for-authentication">3.2.2 - Configure an Identity Provider for Authentication</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>When running Rancher in a production environment, configure an identity provider for authentication.</p>

<p><strong>Rationale</strong></p>

<p>Rancher supports several authentication backends that are common in enterprises. It is recommended to tie Rancher into an external authentication system to simplify user and group access in the Rancher cluster. Doing so assures that access control follows the organization&rsquo;s change management process for user accounts.</p>

<p><strong>Audit</strong></p>

<ul>
<li>In the Rancher UI, select <em>Global</em></li>
<li>Select <em>Security</em></li>
<li>Select <em>Authentication</em></li>
<li>Ensure the authentication provider for your environment is active and configured correctly</li>
</ul>

<p><strong>Remediation</strong></p>

<p>Configure the appropriate authentication provider for your Rancher installation according to the documentation found at the link in the reference section below.</p>

<h4 id="reference-1">Reference</h4>

<ul>
<li><a href="https://rancher.com/docs/rancher/v2.x/en/admin-settings/authentication/">https://rancher.com/docs/rancher/v2.x/en/admin-settings/authentication/</a></li>
</ul>

<h2 id="3-3-rancher-management-control-plane-rbac">3.3 - Rancher Management Control Plane RBAC</h2>

<h3 id="3-3-1-ensure-that-administrator-privileges-are-only-granted-to-those-who-require-them">3.3.1 - Ensure that administrator privileges are only granted to those who require them</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>Restrict administrator access to only those responsible for managing and operating the Rancher server.</p>

<p><strong>Rationale</strong></p>

<p>The <code>admin</code>  privilege level gives the user the highest level of access to the Rancher server and all attached clusters. This privilege should only be granted to a few people who are responsible for the availability and support of Rancher and the clusters that it manages.</p>

<p><strong>Audit</strong></p>

<p>The following script uses the Rancher API to show users with administrator privileges:</p>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="color:#cd2828;font-weight:bold"></span><span style="color:#6ab825;font-weight:bold">for</span> i in <span style="color:#6ab825;font-weight:bold">$(</span>curl -sk -u <span style="color:#ed9d13">&#39;token-&lt;id&gt;:&lt;secret&gt;&#39;</span> https://&lt;RANCHER_URL&gt;/v3/users|jq -r .data[].links.globalRoleBindings<span style="color:#6ab825;font-weight:bold">)</span>; <span style="color:#6ab825;font-weight:bold">do</span>

curl -sk -u <span style="color:#ed9d13">&#39;token-&lt;id&gt;:&lt;secret&gt;&#39;</span> <span style="color:#40ffff">$i</span>| jq <span style="color:#ed9d13">&#39;.data[] | &#34;\(.userId) \(.globalRoleId)&#34;&#39;</span>

<span style="color:#6ab825;font-weight:bold">done</span></code></pre></div>
<p>The <code>admin</code> role should only be assigned to users that require administrative privileges. Any role that is not <code>admin</code> or <code>user</code> should be audited in the RBAC section of the UI to ensure that the privileges adhere to policies for global access.</p>

<p>The Rancher server permits customization of the default global permissions. We recommend that auditors also review the policies of any custom global roles.</p>

<p><strong>Remediation</strong></p>

<p>Remove the <code>admin</code> role from any user that does not require administrative privileges.</p>

<h2 id="3-4-rancher-management-control-plane-configuration">3.4 - Rancher Management Control Plane Configuration</h2>

<h3 id="3-4-1-ensure-only-approved-node-drivers-are-active">3.4.1 - Ensure only approved node drivers are active</h3>

<p><strong>Profile Applicability</strong></p>

<ul>
<li>Level 1</li>
</ul>

<p><strong>Description</strong></p>

<p>Ensure that node drivers that are not needed or approved are not active in the Rancher console.</p>

<p><strong>Rationale</strong></p>

<p>Node drivers are used to provision compute nodes in various cloud providers and local IaaS infrastructure. For convenience, popular cloud providers are enabled by default. If the organization does not intend to use these or does not allow users to provision resources in certain providers, the drivers should be disabled. This will prevent users from using Rancher resources to provision the nodes.</p>

<p><strong>Audit</strong></p>

<ul>
<li>In the Rancher UI select <em>Global</em></li>
<li>Select <em>Node Drivers</em></li>
<li>Review the list of node drivers that are in an <em>Active</em> state.</li>
</ul>

<p><strong>Remediation</strong></p>

<p>If a disallowed node driver is active, visit the <em>Node Drivers</em> page under <em>Global</em> and disable it.</p>

<hr />

<h2 id="appendix-a-complete-rke-cluster-yml-example">Appendix A - Complete RKE <code>cluster.yml</code> Example</h2>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">nodes:<span style="color:#666">
</span><span style="color:#666"></span>-<span style="color:#666"> </span>address:<span style="color:#666"> </span><span style="color:#3677a9">18.191</span>.<span style="color:#3677a9">190.205</span><span style="color:#666">
</span><span style="color:#666">  </span>internal_address:<span style="color:#666"> </span><span style="color:#3677a9">172.31</span>.<span style="color:#3677a9">24.213</span><span style="color:#666">
</span><span style="color:#666">  </span>user:<span style="color:#666"> </span>ubuntu<span style="color:#666">
</span><span style="color:#666">  </span>role:<span style="color:#666"> </span>[<span style="color:#666"> </span><span style="color:#ed9d13">&#34;controlplane&#34;</span>,<span style="color:#666"> </span><span style="color:#ed9d13">&#34;etcd&#34;</span>,<span style="color:#666"> </span><span style="color:#ed9d13">&#34;worker&#34;</span><span style="color:#666"> </span>]<span style="color:#666">
</span><span style="color:#666"></span>-<span style="color:#666"> </span>address:<span style="color:#666"> </span><span style="color:#3677a9">18.191</span>.<span style="color:#3677a9">190.203</span><span style="color:#666">
</span><span style="color:#666">  </span>internal_address:<span style="color:#666"> </span><span style="color:#3677a9">172.31</span>.<span style="color:#3677a9">24.203</span><span style="color:#666">
</span><span style="color:#666">  </span>user:<span style="color:#666"> </span>ubuntu<span style="color:#666">
</span><span style="color:#666">  </span>role:<span style="color:#666"> </span>[<span style="color:#666"> </span><span style="color:#ed9d13">&#34;controlplane&#34;</span>,<span style="color:#666"> </span><span style="color:#ed9d13">&#34;etcd&#34;</span>,<span style="color:#666"> </span><span style="color:#ed9d13">&#34;worker&#34;</span><span style="color:#666"> </span>]<span style="color:#666">
</span><span style="color:#666"></span>-<span style="color:#666"> </span>address:<span style="color:#666"> </span><span style="color:#3677a9">18.191</span>.<span style="color:#3677a9">190.10</span><span style="color:#666">
</span><span style="color:#666">  </span>internal_address:<span style="color:#666"> </span><span style="color:#3677a9">172.31</span>.<span style="color:#3677a9">24.244</span><span style="color:#666">
</span><span style="color:#666">  </span>user:<span style="color:#666"> </span>ubuntu<span style="color:#666">
</span><span style="color:#666">  </span>role:<span style="color:#666"> </span>[<span style="color:#666"> </span><span style="color:#ed9d13">&#34;controlplane&#34;</span>,<span style="color:#666"> </span><span style="color:#ed9d13">&#34;etcd&#34;</span>,<span style="color:#666"> </span><span style="color:#ed9d13">&#34;worker&#34;</span><span style="color:#666"> </span>]<span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666"></span>services:<span style="color:#666">
</span><span style="color:#666">  </span>kubelet:<span style="color:#666">
</span><span style="color:#666">    </span>extra_args:<span style="color:#666">
</span><span style="color:#666">      </span>streaming-connection-idle-timeout:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;1800s&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>authorization-mode:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;Webhook&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>protect-kernel-defaults:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;true&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>make-iptables-util-chains:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;true&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>event-qps:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;0&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>anonymous-auth:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;false&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>feature-gates:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;RotateKubeletServerCertificate=true&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>tls-cipher-suites:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256&#34;</span><span style="color:#666">
</span><span style="color:#666">  </span>kube-api:<span style="color:#666">
</span><span style="color:#666">    </span>pod_security_policy:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">true</span><span style="color:#666">
</span><span style="color:#666">    </span>extra_args:<span style="color:#666">
</span><span style="color:#666">      </span>anonymous-auth:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;false&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>profiling:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;false&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>service-account-lookup:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;true&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>enable-admission-plugins:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;ServiceAccount,NamespaceLifecycle,LimitRanger,PersistentVolumeLabel,DefaultStorageClass,ResourceQuota,DefaultTolerationSeconds,AlwaysPullImages,DenyEscalatingExec,NodeRestriction,EventRateLimit,PodSecurityPolicy&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>encryption-provider-config:<span style="color:#666"> </span>/opt/kubernetes/encryption.yaml<span style="color:#666">
</span><span style="color:#666">      </span>admission-control-config-file:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;/opt/kubernetes/admission.yaml&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>audit-log-path:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;/var/log/kube-audit/audit-log.json&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>audit-log-maxage:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;5&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>audit-log-maxbackup:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;5&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>audit-log-maxsize:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;100&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>audit-log-format:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;json&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>audit-policy-file:<span style="color:#666"> </span>/opt/kubernetes/audit.yaml<span style="color:#666">
</span><span style="color:#666">      </span>tls-cipher-suites:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256&#34;</span><span style="color:#666">
</span><span style="color:#666">    </span>extra_binds:<span style="color:#666">
</span><span style="color:#666">      </span>-<span style="color:#666"> </span><span style="color:#ed9d13">&#34;/var/log/kube-audit:/var/log/kube-audit&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>-<span style="color:#666"> </span><span style="color:#ed9d13">&#34;/opt/kubernetes:/opt/kubernetes&#34;</span><span style="color:#666">
</span><span style="color:#666">  </span>scheduler:<span style="color:#666">
</span><span style="color:#666">    </span>extra_args:<span style="color:#666">
</span><span style="color:#666">      </span>profiling:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;false&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>address:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;127.0.0.1&#34;</span><span style="color:#666">
</span><span style="color:#666">  </span>kube-controller:<span style="color:#666">
</span><span style="color:#666">    </span>extra_args:<span style="color:#666">
</span><span style="color:#666">      </span>profiling:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;false&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>address:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;127.0.0.1&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>terminated-pod-gc-threshold:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;1000&#34;</span><span style="color:#666">
</span><span style="color:#666">      </span>feature-gates:<span style="color:#666"> </span><span style="color:#ed9d13">&#34;RotateKubeletServerCertificate=true&#34;</span><span style="color:#666">
</span><span style="color:#666"></span>addons:<span style="color:#666"> </span><span style="color:#ed9d13">|
</span><span style="color:#ed9d13">  apiVersion: v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>Namespace<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>ingress-nginx<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: rbac.authorization.k8s.io/v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>Role<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>default-psp-role<span style="color:#666">
</span><span style="color:#666">    </span>namespace:<span style="color:#666"> </span>ingress-nginx<span style="color:#666">
</span><span style="color:#666">  </span>rules:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroups:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>extensions<span style="color:#666">
</span><span style="color:#666">    </span>resourceNames:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>default-psp<span style="color:#666">
</span><span style="color:#666">    </span>resources:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>podsecuritypolicies<span style="color:#666">
</span><span style="color:#666">    </span>verbs:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>use<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: rbac.authorization.k8s.io/v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>RoleBinding<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>default-psp-rolebinding<span style="color:#666">
</span><span style="color:#666">    </span>namespace:<span style="color:#666"> </span>ingress-nginx<span style="color:#666">
</span><span style="color:#666">  </span>roleRef:<span style="color:#666">
</span><span style="color:#666">    </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Role<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>default-psp-role<span style="color:#666">
</span><span style="color:#666">  </span>subjects:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Group<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>system:serviceaccounts<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Group<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>system:authenticated<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>Namespace<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>cattle-system<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: rbac.authorization.k8s.io/v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>Role<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>default-psp-role<span style="color:#666">
</span><span style="color:#666">    </span>namespace:<span style="color:#666"> </span>cattle-system<span style="color:#666">
</span><span style="color:#666">  </span>rules:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroups:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>extensions<span style="color:#666">
</span><span style="color:#666">    </span>resourceNames:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>default-psp<span style="color:#666">
</span><span style="color:#666">    </span>resources:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>podsecuritypolicies<span style="color:#666">
</span><span style="color:#666">    </span>verbs:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>use<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: rbac.authorization.k8s.io/v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>RoleBinding<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>default-psp-rolebinding<span style="color:#666">
</span><span style="color:#666">    </span>namespace:<span style="color:#666"> </span>cattle-system<span style="color:#666">
</span><span style="color:#666">  </span>roleRef:<span style="color:#666">
</span><span style="color:#666">    </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Role<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>default-psp-role<span style="color:#666">
</span><span style="color:#666">  </span>subjects:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Group<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>system:serviceaccounts<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Group<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>system:authenticated<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: extensions/v1beta1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>PodSecurityPolicy<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>restricted<span style="color:#666">
</span><span style="color:#666">  </span>spec:<span style="color:#666">
</span><span style="color:#666">    </span>requiredDropCapabilities:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>NET_RAW<span style="color:#666">
</span><span style="color:#666">    </span>privileged:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">false</span><span style="color:#666">
</span><span style="color:#666">    </span>allowPrivilegeEscalation:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">false</span><span style="color:#666">
</span><span style="color:#666">    </span>defaultAllowPrivilegeEscalation:<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">false</span><span style="color:#666">
</span><span style="color:#666">    </span>fsGroup:<span style="color:#666">
</span><span style="color:#666">      </span>rule:<span style="color:#666"> </span>RunAsAny<span style="color:#666">
</span><span style="color:#666">    </span>runAsUser:<span style="color:#666">
</span><span style="color:#666">      </span>rule:<span style="color:#666"> </span>MustRunAsNonRoot<span style="color:#666">
</span><span style="color:#666">    </span>seLinux:<span style="color:#666">
</span><span style="color:#666">      </span>rule:<span style="color:#666"> </span>RunAsAny<span style="color:#666">
</span><span style="color:#666">    </span>supplementalGroups:<span style="color:#666">
</span><span style="color:#666">      </span>rule:<span style="color:#666"> </span>RunAsAny<span style="color:#666">
</span><span style="color:#666">    </span>volumes:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>emptyDir<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>secret<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>persistentVolumeClaim<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>downwardAPI<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>configMap<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>projected<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: rbac.authorization.k8s.io/v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>ClusterRole<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>psp:restricted<span style="color:#666">
</span><span style="color:#666">  </span>rules:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroups:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>extensions<span style="color:#666">
</span><span style="color:#666">    </span>resourceNames:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>restricted<span style="color:#666">
</span><span style="color:#666">    </span>resources:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>podsecuritypolicies<span style="color:#666">
</span><span style="color:#666">    </span>verbs:<span style="color:#666">
</span><span style="color:#666">    </span>-<span style="color:#666"> </span>use<span style="color:#666">
</span><span style="color:#666">  </span>--<span style="color:#ed9d13">-
</span><span style="color:#ed9d13">  apiVersion: rbac.authorization.k8s.io/v1</span><span style="color:#666">
</span><span style="color:#666">  </span>kind:<span style="color:#666"> </span>ClusterRoleBinding<span style="color:#666">
</span><span style="color:#666">  </span>metadata:<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>psp:restricted<span style="color:#666">
</span><span style="color:#666">  </span>roleRef:<span style="color:#666">
</span><span style="color:#666">    </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>ClusterRole<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>psp:restricted<span style="color:#666">
</span><span style="color:#666">  </span>subjects:<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Group<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>system:serviceaccounts<span style="color:#666">
</span><span style="color:#666">  </span>-<span style="color:#666"> </span>apiGroup:<span style="color:#666"> </span>rbac.authorization.k8s.io<span style="color:#666">
</span><span style="color:#666">    </span>kind:<span style="color:#666"> </span>Group<span style="color:#666">
</span><span style="color:#666">    </span>name:<span style="color:#666"> </span>system:authenticated</code></pre></div>

            
            
            </div>
            


            <div class="p-v-xs">
<div class="buttons-container">
    <a href="https://github.com/rancher/docs/edit/master/content/rancher/v2.x/en/security/hardening-2.2/_index.md" class="btn bg-link">
        <button class="button has-icon-right">
            <span>Edit this page</span>
            <svg class="icon right" enable-background="new 0 0 34 34" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg">
                <g>
                    <path class="svg-linear" d="m19.5 12 5 5-5 5"></path>
                    <path class="svg-linear" d="m24.5 17h-15"></path>
                </g>
            </svg>
        </button>
    </a>
</div>
</div>
          </article>
          
        </div>
      </div>
    </div>
  </section>


  <script>
    $(document).ready(function() {
      $('.guide-menus-activator').click(function() {
        $('.docs-container .side-menus').toggleClass('show');
      });

      
      $("a[href*='#']").click(function(e) {
      

        if ($(this).attr('data-target') === undefined && $(this).attr('href').length > 1) {
          var hash = $(this).attr('href').substring(1),
              objt = $('#' + hash),
              objt_mt = Number(objt.css('margin-top').replace(/[^0-9]/g,"")),
              depth = 80,
              scrn = $(window).width();
              scrn_check = 1025;

          if (scrn < scrn_check) {
            depth = 120;
          }

          if (objt_mt > 0) {
            depth = depth + objt_mt
          }

          if ($(this).attr('href').charAt(0) === '#') {
            var objectTop = $($(this).attr('href')).offset().top;

            setTimeout(function() {
              $('html').scrollTop(objectTop - depth);
            }, 100);
          }
        }
      });
    });
  </script>







  
  

    <footer>

        <div class="footer-container">
            <div class="grid-container informations">
                <div class="row max-sized">
                    <div class="
                        col-xl-3
                        col-lg-3
                        col-md-4
                        col-sm-12
                        col-12">
                        <div class="footer-side-items">
                            <div class="footer-news-letter-form">
                                <div class="label">Get the latest news</div>

                                <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>
                                <script>
                                  hbspt.forms.create({
                                    css: '',
                                    portalId: '468859',
                                    formId: '8beed251-ecf0-49fc-93a1-fa9b1446110f',
                                    translations: {
                                      en: {
                                        submitText: " "
                                      }
                                    }
                                  });
                                </script>
                            </div>

                            <div class="footer-connect-sns">
                                <div class="label">Connect with us</div>

                                <ul>
                                    <li>
                                        <a href="https://twitter.com/Rancher_Labs" target="_blank"><img src="/imgs/icon-twitter.svg"></a>
                                    </li>
                                    <li>
                                        <a href="https://www.linkedin.com/company/rancher" target="_blank"><img src="/imgs/icon-linkedin.svg"></a>
                                    </li>
                                    <li>
                                        <a href="https://www.facebook.com/rancherlabs/" target="_blank"><img src="/imgs/icon-facebook.svg"></a>
                                    </li>
                                    <li>
                                        <a href="https://www.youtube.com/channel/UCh5Xtp82q8wjijP8npkVTBA" target="_blank"><img src="/imgs/icon-youtube.svg"></a>
                                    </li>
                                    <li>
                                        <a href="https://github.com/rancher/rancher" target="_blank"><img src="/imgs/icon-github.svg"></a>
                                    </li>
                                    <li>
                                        <a href="https://slack.rancher.io/" target="_blank"><img src="/imgs/icon-slack.svg"></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="
                        col-xl-8 offset-xl-1
                        col-lg-9 offset-lg-0
                        col-md-8 offset-md-0
                        col-sm-12 offset-sm-0
                        col-12">
                        <div class="row footer-sitemaps">
                            <ul class="
                                col-xl-3
                                col-lg-3
                                col-md-3
                                col-sm-6
                                col-xs-6
                                col-6
                                ">
                                <div class="label">Products</div>
                                <li><a href="/products/rancher/">Rancher</a></li>
                                <li><a href="/products/rke/">RKE</a></li>
                                <li><a href="http://k3s.io" target="_blank">k3s</a></li>
                                <li><a href="https://rio.io/" target="_blank">Rio</a></li>
                                <li><a href="/support/request/">Get Support</a></li>
                                <li><a href="/pricing/">Pricing</a></li>
                                <li><a href="/request-a-demo/">Request a Demo</a></li>
                            </ul>
                            <ul class="
                                col-xl-3
                                col-lg-3
                                col-md-3
                                col-sm-6
                                col-xs-6
                                col-6
                                ">
                                <div class="label">Community</div>
                                <li><a href="/events/">Events</a></li>
                                <li><a href="/online-meetups/">Online Meetups</a></li>
                                <li><a href="/training/">Training</a></li>
                                <li><a href="/tutorials/">Tutorials</a></li>
                                <li><a href="/kubernetes-master-class/">Kubernetes Master Classes</a></li>
                                <li><a href="/writing-program/">Rancher Writing Program</a></li>
                                <li><a href="https://forums.rancher.com/">Forums</a></li>
                                <li><a href="http://slack.rancher.io/">Slack</a></li>
                                <li><a href="https://github.com/rancher/">GitHub</a></li>
                            </ul>
                            <ul class="
                                col-xl-3
                                col-lg-3
                                col-md-3
                                col-sm-6
                                col-xs-6
                                col-6
                                ">
                                <div class="label">Resources</div>
                                <li><a href="/docs/rancher/v2.x/en/">Rancher 2.x Docs</a></li>
                                <li><a href="/docs/rancher/v1.6/en/">Rancher 1.6 Docs</a></li>
                                <li><a href="/docs/rke/latest/en/">RKE Docs</a></li>
                                <li><a href="/docs/k3s/latest/en/">k3s Docs</a></li>
                                <li><a href="/docs/os/v1.x/en/">RancherOS Docs</a></li>
                                <li><a href="/ebooks-and-whitepapers/">eBooks and White Papers</a></li>
                                <li><a href="/videos-and-podcasts/">Videos and Podcasts</a></li>
                                <li><a href="/quick-start/">Getting Started Guide</a></li>
                                <li><a href="/kubernetes/">Why Kubernetes</a></li>
                            </ul>
                            <ul class="
                                col-xl-3
                                col-lg-3
                                col-md-3
                                col-sm-6
                                col-xs-6
                                col-6
                                ">
                                <div class="label">Company</div>
                                <li><a href="/about/">About Us</a></li>
                                <li><a href="/customers/">Customers</a></li>
                                <li><a href="/partners/">Partners</a></li>
                                <li><a href="/careers/">Careers</a></li>
                                <li><a href="/blog/">Blog</a></li>
                                <li><a href="/press/">Press</a></li>
                                <li><a href="/contact/">Contact Us</a></li>
                                <li><a href="https://www.rancher.cn/">China Site</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid-container footer-copyright">
                <div class="row align-items-center grid-row max-sized footer-copyright-wrap">
                    <div class="
                        col-xl-6
                        col-lg-6
                        col-md-6
                        col-sm-12
                        col-xs-12
                        col-12
                        text">
                        © Copyright 2020 Rancher. All Rights Reserved.
                    </div>
                    <div class="
                        col-xl-6
                        col-lg-6
                        col-md-6
                        col-sm-12
                        col-xs-12
                        col-12
                        sub-menus">
                        <ul>
                            <li><a href="/privacy/">Privacy Policy</a></li>
                            <li><a href="/agreements/">Agreements</a></li>
                            <li><a href="/support-maintenance-terms/">Terms of Service</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </footer>


</div>

<script>

var VAR_DATAS = {
    SPEED_SLIDE:         1000,
    SPEED_SLIDE_DELAYED: 1200,
    SPEED_AUTOPLAY:      4000
};



function sliderProgressPlay(slider, progressBar, duration, repeatable) {
    
    progressBar.stop().css('width', 0);

    progressBar.animate({
        width: '100%'
    }, duration || 5000, function() { 
        
        progressBar.animate({width: '0%'}, 100);

        
        slider.slick('slickNext');

        if (repeatable) sliderProgressPlay(slider, progressBar, duration, repeatable);
    });
}

function scrollPage(hash) {
    var hash = hash.substring(1),
        objt = $('#' + hash),
        objt_mt = Number(objt.css('margin-top').replace(/[^0-9]/g,"")),
        depth = 80,
        scrn = $(window).width();
        scrn_check = 1025;

    if (scrn < scrn_check) {
        depth = 160;
    }

    if (objt_mt > 0) {
        depth = depth + objt_mt
    }

    setTimeout(function() {
        $('html').animate({
            'scrollTop': objt.offset().top - depth
        }, 400);
    }, 100);

    
}


$(document).ready(function() {
    
    ;(function ( $, window, document, undefined ) {
        var pluginName = "jqueryAccordionMenu";
        var defaults = {
                speed: 300,
                showDelay: 0,
                hideDelay: 0,
                singleOpen: true,
                clickEffect: true
            };

        function Plugin ( element, options ) {
            this.element = element;
            this.settings = $.extend( {}, defaults, options );
            this._defaults = defaults;
            this._name = pluginName;
            this.init();
        };

        $.extend(Plugin.prototype, {

            init: function () {
                this.openSubmenu();
                this.submenuIndicators();
                if(this.settings.clickEffect){
                    this.addClickEffect();
                }
            },

            openSubmenu: function () {
                var opts = this.settings; 
                $(this.element).children("ul").find("li").bind("click", function(e){
                    e.stopPropagation();
                    e.preventDefault();

                    if ($(this).attr('class') === 'back-to-the-top') {
                        $('.mobile-header-container').scrollTop(0);
                    }

                    if($(this).children(".submenu").length > 0){
                        if($(this).children(".submenu").css("display") == "none"){
                            $(this).children(".submenu").delay(opts.showDelay).slideDown(opts.speed);
                            $(this).children(".submenu").siblings("a").addClass("submenu-indicator-minus");
                            $(this).addClass("activate");
                            if(opts.singleOpen){
                                $(this).siblings().children(".submenu").slideUp(opts.speed);
                                $(this).siblings().children(".submenu").siblings("a").removeClass("submenu-indicator-minus");
                                $(this).removeClass("activate");
                            }

                            return false;
                        }else {
                            $(this).children(".submenu").delay(opts.hideDelay).slideUp(opts.speed);
                        }

                        if($(this).children(".submenu").siblings("a").hasClass("submenu-indicator-minus")){
                            $(this).children(".submenu").siblings("a").removeClass("submenu-indicator-minus");
                            $(this).removeClass("activate");
                        }
                    }

                    window.location.href = $(this).children("a").attr("href");
                });
            },

            submenuIndicators: function () {
                if($(this.element).find(".submenu").length > 0){
                    $(this.element).find(".submenu").siblings("a").append("<span class='submenu-indicator'><span class='object1'></span><span class='object2'></span><span class='object3'></span></span>");
                }
            },

            addClickEffect: function () {
                var ink, d, x, y;

                $(this.element).find("a").bind("click", function(e){

                    $(".ink").remove();

                    if($(this).children(".ink").length === 0){
                        $(this).prepend("<span class='ink'></span>");
                    }

                    ink = $(this).find(".ink");
                    ink.removeClass("animate-ink");

                    if(!ink.height() && !ink.width()){
                        d = Math.max($(this).outerWidth(), $(this).outerHeight());
                        ink.css({height: d, width: d});
                    }

                    x = e.pageX - $(this).offset().left - ink.width()/2;
                    y = e.pageY - $(this).offset().top - ink.height()/2;

                    ink.css({top: y+'px', left: x+'px'}).addClass("animate-ink");
                });
            }

        });

        $.fn[ pluginName ] = function ( options ) {
            this.each(function() {
                if ( !$.data( this, "plugin_" + pluginName ) ) {
                    $.data( this, "plugin_" + pluginName, new Plugin( this, options ) );
                }
            });
            return this;
        };
    })( jQuery, window, document );

    
    var mobileNavActivator = $('.mobile-menu-opener'),
        mobileNavContainer = $('.mobile-header-container'),
        mobileNavMenus     = $('.nav-mobile-menus');

    mobileNavMenus.jqueryAccordionMenu();

    mobileNavActivator.click(function() {
        if (mobileNavContainer.hasClass('active')) {
            mobileNavContainer.removeClass('active');
        } else {
            mobileNavContainer.addClass('active');
        }
    });


    
    ScrollReveal().reveal('.decoration.cloud.right', {
        delay: 400,
        origin: 'right',
        duration: 1500,
        distance: '50%'
    });


    
    
    
    
    
    
    ScrollReveal().reveal('footer .get-started-container .rancher-logo', {
        delay: 200,
        origin: 'bottom',
        distance: '20%',
        opacity: 0,
        viewFactor: .5,
        mobile: false
    });


    if(window.location.hash) {
        scrollPage(window.location.hash);
    }

    $('.docs-wrap .accordion > label').click(function() {
        if ($(this).parent().hasClass('active')) {
            $(this).parent().removeClass('active');
        } else {
            $(this).parent().addClass('active');
        }
    });

    var mobileNavContainer = $('.mobile-header-container');

    if ($(this).scrollTop() > 50) {
        mobileNavContainer.addClass('add-blinder');
    } else {
        mobileNavContainer.removeClass('add-blinder');
    }

    var stkNav = $('.header-container');

    if ($(window).scrollTop() > 50) {
        stkNav.addClass('sticky');
    } else {
        stkNav.removeClass('sticky');
    }
}).on("scroll", function(e) {
    var mobileNavContainer = $('.mobile-header-container');

    if ($(this).scrollTop() > 50) {
        mobileNavContainer.addClass('add-blinder');
    } else {
        mobileNavContainer.removeClass('add-blinder');
    }

    var stkNav = $('.header-container');

    if ($(window).scrollTop() > 50) {
        stkNav.addClass('sticky');
    } else {
        stkNav.removeClass('sticky');
    }
});
</script>



  
  <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/468859.js"></script>
  


<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5af1cc6793d86bfb" async></script>


</body>
</html>

